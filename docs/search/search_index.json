{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"OAuth2.0\u7684Saas\u7528\u6237\u4e2d\u5fc3\u6846\u67b6\u3002\uff08\u57fa\u4e8eAspNet Core Identity\u3001IdentityServer4\uff09 OAuthApp \u00b6 \u76ee\u524d\u53ef\u7528\u4e8e\u751f\u4ea7\u73af\u5883\u7684\u63a5\u53e3\u5217\u8868 \u5fae\u670d\u52a1 Blob \u5ba2\u6237\u7aef \u4ee3\u7801\u751f\u6210 \u6807\u8bc6 \u89d2\u8272 \u79df\u6237 \u7528\u6237 \u5176\u4ed6 \u63a7\u5236\u53f0 \u00b6 \u7edf\u4e00\u7684\u7ba1\u7406\u4e2d\u53f0\u3002","title":"\u6982\u8ff0"},{"location":"#oauthapp","text":"\u76ee\u524d\u53ef\u7528\u4e8e\u751f\u4ea7\u73af\u5883\u7684\u63a5\u53e3\u5217\u8868 \u5fae\u670d\u52a1 Blob \u5ba2\u6237\u7aef \u4ee3\u7801\u751f\u6210 \u6807\u8bc6 \u89d2\u8272 \u79df\u6237 \u7528\u6237 \u5176\u4ed6","title":"OAuthApp"},{"location":"#_1","text":"\u7edf\u4e00\u7684\u7ba1\u7406\u4e2d\u53f0\u3002","title":"\u63a7\u5236\u53f0"},{"location":"apidocument/","text":"\u63a5\u53e3\u6587\u6863 \u00b6 122121","title":"\u63a5\u53e3\u6587\u6863"},{"location":"apidocument/#_1","text":"122121","title":"\u63a5\u53e3\u6587\u6863"},{"location":"auth-code/","text":"\u6388\u6743\u7801\u6a21\u5f0f \u00b6 \u6388\u6743\u7801\u6a21\u5f0f\uff08authorization code\uff09\u662f\u529f\u80fd\u6700\u5b8c\u6574\u3001\u6d41\u7a0b\u6700\u4e25\u5bc6\u7684\u6388\u6743\u6a21\u5f0f\uff0ccode\u4fdd\u8bc1\u4e86token\u7684\u5b89\u5168\u6027\uff0c\u5373\u4f7fcode\u88ab\u62e6\u622a\uff0c\u7531\u4e8e\u6ca1\u6709app_secret\uff0c\u4e5f\u662f\u65e0\u6cd5\u901a\u8fc7code\u83b7\u5f97token\u7684\u3002 \u9002\u7528\u573a\u666f \u00b6 \u7b2c\u4e09\u65b9Web\u670d\u52a1\u5668\u7aef\u5e94\u7528\u4e0e\u7b2c\u4e09\u65b9\u539f\u751fApp\u3002 \u4f7f\u7528\u8bf4\u660e \u00b6 1\uff0c\u83b7\u53d6\u6388\u6743\u7801 \u00b6 \u5f53\u4f7f\u7528Client\u53d1\u8d77\u4e00\u4e2a\u6388\u6743\u7801\u6a21\u5f0f\u8bf7\u6c42\u65f6\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --GET {server}/connect/authorize?response_type=code&client_id={client_id}&redirect_uri={redirect_uri}&scope={scope}&nonce={nonce} \u53c2\u6570\u8bf4\u660e \u00b6 \u540d\u79f0 \u662f\u5426\u5fc5\u987b \u8bf4\u660e response_type \u662f \u54cd\u5e94\u7c7b\u578b\uff0c\u503c\u56fa\u5b9a\u4e3a code client_id \u662f \u5e94\u7528\u7684ID redirect_uri \u662f \u56de\u8c03\u5730\u5740 scope \u662f \u7533\u8bf7\u6388\u6743\u7684 scope \uff0c\u591a\u4e2ascope\u7528\u7a7a\u683c\u5206\u9694\u3002 nonce \u662f \u968f\u673a\u5b57\u7b26\u4e32 \u54cd\u5e94\u683c\u5f0f \u00b6 \u5f53\u7528\u6237\u6388\u6743\u6210\u529f\u540e\uff0c\u670d\u52a1\u5668\u4f1a\u5c06\u6388\u6743\u7801\u4e00\u8d77\u56de\u4f20\u5230\u56de\u8c03\u5730\u5740\uff1a {redirect_uri}?code={code} 2\uff0c\u83b7\u53d6AccessToken \u00b6 \u901a\u8fc7code\uff08\u6388\u6743\u7801\uff09\u6362\u53d6AccessToken\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --POST {server}/connect/token \u53c2\u6570\u8bf4\u660e \u00b6 \u540d\u79f0 \u662f\u5426\u5fc5\u987b \u8bf4\u660e grant_type \u662f \u6388\u6743\u7c7b\u578b\uff0c\u503c\u56fa\u5b9a\u4e3a authorization_code code \u662f \u6b65\u9aa41\u8fd4\u56de\u7684\u6388\u6743\u7801 client_id \u662f \u5e94\u7528\u7684ID client_secret \u662f \u5e94\u7528\u7684\u5bc6\u94a5 scope \u662f \u7533\u8bf7\u6388\u6743\u7684 scope \uff0c\u591a\u4e2ascope\u7528\u7a7a\u683c\u5206\u9694\u3002 redirect_uri \u662f \u4e0e\u6b65\u9aa41\u7684\u56de\u8c03\u5730\u5740\u4fdd\u6301\u4e00\u81f4 \u54cd\u5e94\u683c\u5f0f \u00b6 { \"access_token\" : \"***AccessToken***\" , \"expires_in\" : 3600 , \"token_type\" : \"Bearer\" , \"scope\" : \"***scopes***\" }","title":"\u6388\u6743\u7801\u6a21\u5f0f"},{"location":"auth-code/#_1","text":"\u6388\u6743\u7801\u6a21\u5f0f\uff08authorization code\uff09\u662f\u529f\u80fd\u6700\u5b8c\u6574\u3001\u6d41\u7a0b\u6700\u4e25\u5bc6\u7684\u6388\u6743\u6a21\u5f0f\uff0ccode\u4fdd\u8bc1\u4e86token\u7684\u5b89\u5168\u6027\uff0c\u5373\u4f7fcode\u88ab\u62e6\u622a\uff0c\u7531\u4e8e\u6ca1\u6709app_secret\uff0c\u4e5f\u662f\u65e0\u6cd5\u901a\u8fc7code\u83b7\u5f97token\u7684\u3002","title":"\u6388\u6743\u7801\u6a21\u5f0f"},{"location":"auth-code/#_2","text":"\u7b2c\u4e09\u65b9Web\u670d\u52a1\u5668\u7aef\u5e94\u7528\u4e0e\u7b2c\u4e09\u65b9\u539f\u751fApp\u3002","title":"\u9002\u7528\u573a\u666f"},{"location":"auth-code/#_3","text":"","title":"\u4f7f\u7528\u8bf4\u660e"},{"location":"auth-code/#1","text":"\u5f53\u4f7f\u7528Client\u53d1\u8d77\u4e00\u4e2a\u6388\u6743\u7801\u6a21\u5f0f\u8bf7\u6c42\u65f6\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --GET {server}/connect/authorize?response_type=code&client_id={client_id}&redirect_uri={redirect_uri}&scope={scope}&nonce={nonce}","title":"1\uff0c\u83b7\u53d6\u6388\u6743\u7801"},{"location":"auth-code/#_4","text":"\u540d\u79f0 \u662f\u5426\u5fc5\u987b \u8bf4\u660e response_type \u662f \u54cd\u5e94\u7c7b\u578b\uff0c\u503c\u56fa\u5b9a\u4e3a code client_id \u662f \u5e94\u7528\u7684ID redirect_uri \u662f \u56de\u8c03\u5730\u5740 scope \u662f \u7533\u8bf7\u6388\u6743\u7684 scope \uff0c\u591a\u4e2ascope\u7528\u7a7a\u683c\u5206\u9694\u3002 nonce \u662f \u968f\u673a\u5b57\u7b26\u4e32","title":"\u53c2\u6570\u8bf4\u660e"},{"location":"auth-code/#_5","text":"\u5f53\u7528\u6237\u6388\u6743\u6210\u529f\u540e\uff0c\u670d\u52a1\u5668\u4f1a\u5c06\u6388\u6743\u7801\u4e00\u8d77\u56de\u4f20\u5230\u56de\u8c03\u5730\u5740\uff1a {redirect_uri}?code={code}","title":"\u54cd\u5e94\u683c\u5f0f"},{"location":"auth-code/#2accesstoken","text":"\u901a\u8fc7code\uff08\u6388\u6743\u7801\uff09\u6362\u53d6AccessToken\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --POST {server}/connect/token","title":"2\uff0c\u83b7\u53d6AccessToken"},{"location":"auth-code/#_6","text":"\u540d\u79f0 \u662f\u5426\u5fc5\u987b \u8bf4\u660e grant_type \u662f \u6388\u6743\u7c7b\u578b\uff0c\u503c\u56fa\u5b9a\u4e3a authorization_code code \u662f \u6b65\u9aa41\u8fd4\u56de\u7684\u6388\u6743\u7801 client_id \u662f \u5e94\u7528\u7684ID client_secret \u662f \u5e94\u7528\u7684\u5bc6\u94a5 scope \u662f \u7533\u8bf7\u6388\u6743\u7684 scope \uff0c\u591a\u4e2ascope\u7528\u7a7a\u683c\u5206\u9694\u3002 redirect_uri \u662f \u4e0e\u6b65\u9aa41\u7684\u56de\u8c03\u5730\u5740\u4fdd\u6301\u4e00\u81f4","title":"\u53c2\u6570\u8bf4\u660e"},{"location":"auth-code/#_7","text":"{ \"access_token\" : \"***AccessToken***\" , \"expires_in\" : 3600 , \"token_type\" : \"Bearer\" , \"scope\" : \"***scopes***\" }","title":"\u54cd\u5e94\u683c\u5f0f"},{"location":"auth-credentials/","text":"\u5ba2\u6237\u7aef\u6a21\u5f0f \u00b6 \u5ba2\u6237\u7aef\u6a21\u5f0f\uff08client credentials\uff09\u4e00\u822c\u7528\u4e8e\u8d44\u6e90\u670d\u52a1\u5668\u662f\u5e94\u7528\u7684\u4e00\u4e2a\u540e\u7aef\u6a21\u5757\uff0c\u5ba2\u6237\u7aef\u5411\u8ba4\u8bc1\u670d\u52a1\u5668\u9a8c\u8bc1\u8eab\u4efd\u6765\u83b7\u53d6\u4ee4\u724c\u3002 \u9002\u7528\u573a\u666f \u00b6 \u6ca1\u6709\u7528\u6237\u53c2\u4e0e\u7684\uff0c\u5b8c\u5168\u4fe1\u4efb\u7684\u670d\u52a1\u5668\u7aef\u670d\u52a1\u3002 \u4f7f\u7528\u8bf4\u660e \u00b6 \u83b7\u53d6AccessToken \u00b6 \u5f53\u4f7f\u7528Client\u53d1\u8d77\u4e00\u4e2a\u5ba2\u6237\u7aef\u6a21\u5f0f\u8bf7\u6c42\u65f6\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --POST {server}/connect/token \u53c2\u6570\u8bf4\u660e \u00b6 \u540d\u79f0 \u662f\u5426\u5fc5\u987b \u8bf4\u660e grant_type \u662f \u6388\u6743\u7c7b\u578b\uff0c\u503c\u56fa\u5b9a\u4e3a client_credentials client_id \u662f \u5e94\u7528\u7684ID client_secret \u662f \u5e94\u7528\u7684\u5bc6\u94a5 scope \u662f \u8868\u793a\u6388\u6743\u8303\u56f4\uff0c\u591a\u4e2a scope \u7528\u7a7a\u683c\u5206\u9694\u3002 \u54cd\u5e94\u683c\u5f0f \u00b6 { \"access_token\" : \"***AccessToken***\" , \"expires_in\" : 3600 , \"token_type\" : \"Bearer\" , \"scope\" : \"***scopes***\" }","title":"\u5ba2\u6237\u7aef\u6a21\u5f0f"},{"location":"auth-credentials/#_1","text":"\u5ba2\u6237\u7aef\u6a21\u5f0f\uff08client credentials\uff09\u4e00\u822c\u7528\u4e8e\u8d44\u6e90\u670d\u52a1\u5668\u662f\u5e94\u7528\u7684\u4e00\u4e2a\u540e\u7aef\u6a21\u5757\uff0c\u5ba2\u6237\u7aef\u5411\u8ba4\u8bc1\u670d\u52a1\u5668\u9a8c\u8bc1\u8eab\u4efd\u6765\u83b7\u53d6\u4ee4\u724c\u3002","title":"\u5ba2\u6237\u7aef\u6a21\u5f0f"},{"location":"auth-credentials/#_2","text":"\u6ca1\u6709\u7528\u6237\u53c2\u4e0e\u7684\uff0c\u5b8c\u5168\u4fe1\u4efb\u7684\u670d\u52a1\u5668\u7aef\u670d\u52a1\u3002","title":"\u9002\u7528\u573a\u666f"},{"location":"auth-credentials/#_3","text":"","title":"\u4f7f\u7528\u8bf4\u660e"},{"location":"auth-credentials/#accesstoken","text":"\u5f53\u4f7f\u7528Client\u53d1\u8d77\u4e00\u4e2a\u5ba2\u6237\u7aef\u6a21\u5f0f\u8bf7\u6c42\u65f6\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --POST {server}/connect/token","title":"\u83b7\u53d6AccessToken"},{"location":"auth-credentials/#_4","text":"\u540d\u79f0 \u662f\u5426\u5fc5\u987b \u8bf4\u660e grant_type \u662f \u6388\u6743\u7c7b\u578b\uff0c\u503c\u56fa\u5b9a\u4e3a client_credentials client_id \u662f \u5e94\u7528\u7684ID client_secret \u662f \u5e94\u7528\u7684\u5bc6\u94a5 scope \u662f \u8868\u793a\u6388\u6743\u8303\u56f4\uff0c\u591a\u4e2a scope \u7528\u7a7a\u683c\u5206\u9694\u3002","title":"\u53c2\u6570\u8bf4\u660e"},{"location":"auth-credentials/#_5","text":"{ \"access_token\" : \"***AccessToken***\" , \"expires_in\" : 3600 , \"token_type\" : \"Bearer\" , \"scope\" : \"***scopes***\" }","title":"\u54cd\u5e94\u683c\u5f0f"},{"location":"auth-hybrid/","text":"\u6df7\u5408\u6a21\u5f0f \u00b6 \u6df7\u5408\u6a21\u5f0f\uff08hybrid\uff09\u662f\u7b80\u5316\u6a21\u5f0f\u3001\u6388\u6743\u7801\u6a21\u5f0f\u4e24\u8005\u7684\u6df7\u5408\uff0c\u5728\u8be5\u6d41\u7a0b\u91cc\uff0c\u6709\u4e00\u4e9bTokens\u548c\u6388\u6743\u7801\u6765\u81ea\u4e8e\u6388\u6743\u91cd\u70b9\uff0c\u800c\u53e6\u5916\u4e00\u4e9bTokens\u5219\u6765\u81ea\u4e8eToken\u7aef\u70b9\u3002\u8be5\u6d41\u7a0b\u5141\u8bb8\u5ba2\u6237\u7aef\u7acb\u5373\u4f7f\u7528ID Token\uff0c\u5e76\u4e14\u53ea\u9700\u8981\u4e00\u6b21\u5f80\u8fd4\u5373\u53ef\u83b7\u5f97\u6388\u6743\u7801\u3002 \u9002\u7528\u573a\u666f \u00b6 \u5ba2\u6237\u7aef\u5e94\u7528\u53ef\u4ee5\u5b89\u5168\u7684\u7ef4\u62a4Secret\uff0c\u5b83\u4e5f\u9002\u5408\u4e8e\u957f\u65f6\u95f4\u7684\u8bbf\u95ee\u3002 \u4f7f\u7528\u8bf4\u660e \u00b6 1\uff0c\u83b7\u53d6\u6388\u6743\u7801\u548c\u6807\u8bc6\u4ee4\u724c \u00b6 \u5f53\u4f7f\u7528Client\u53d1\u8d77\u4e00\u4e2a\u6388\u6743\u7801\u6a21\u5f0f\u8bf7\u6c42\u65f6\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --GET {server}/connect/authorize?response_type=id_token code&client_id={client_id}&redirect_uri={redirect_uri}&scope={scope}&nonce={nonce} \u53c2\u6570\u8bf4\u660e \u00b6 \u540d\u79f0 \u662f\u5426\u5fc5\u987b \u8bf4\u660e response_type \u662f \u56fa\u5b9a\u4f20id_token code client_id \u662f \u5e94\u7528\u7684ID redirect_uri \u662f \u56de\u8c03\u5730\u5740 scope \u662f \u7533\u8bf7\u6388\u6743\u7684 scope \uff0c\u591a\u4e2ascope\u7528\u7a7a\u683c\u5206\u9694\u3002 nonce \u662f \u968f\u673a\u5b57\u7b26\u4e32 \u54cd\u5e94\u683c\u5f0f \u00b6 \u5f53\u7528\u6237\u6388\u6743\u6210\u529f\u540e\uff0c\u670d\u52a1\u5668\u4f1a\u5c06\u6388\u6743\u7801\u548c\u8eab\u4efd\u4ee4\u724c\u4e00\u8d77\u56de\u4f20\u5230\u56de\u8c03\u5730\u5740\uff1a {redirect_uri}?code= ***code*** &id_token= ***id_token*** 2\uff0c\u83b7\u53d6AccessToken \u00b6 \u901a\u8fc7code\uff08\u6388\u6743\u7801\uff09\u6362\u53d6AccessToken\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --POST {server}/connect/token \u53c2\u6570\u8bf4\u660e \u00b6 \u540d\u79f0 \u662f\u5426\u5fc5\u987b \u8bf4\u660e grant_type \u662f \u6388\u6743\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u4e3a code id_token \u3001 code token \u3001 code id_token token code \u662f \u6b65\u9aa41\u8fd4\u56de\u7684\u6388\u6743\u7801 client_id \u662f \u5e94\u7528\u7684ID client_secret \u662f \u5e94\u7528\u7684\u5bc6\u94a5 scope \u662f \u8868\u793a\u6388\u6743\u8303\u56f4\uff0c\u591a\u4e2a scope \u7528\u7a7a\u683c\u5206\u9694\u3002 redirect_uri \u662f \u4e0e\u6b65\u9aa41\u7684\u56de\u8c03\u5730\u5740\u4fdd\u6301\u4e00\u81f4 \u54cd\u5e94\u683c\u5f0f \u00b6 { \"access_token\" : \"***AccessToken***\" , \"expires_in\" : 3600 , \"token_type\" : \"Bearer\" , \"scope\" : \"***scopes***\" } 3\uff0c\u83b7\u53d6\u7528\u6237\u4fe1\u606f \u00b6 \u901a\u8fc7id_token\uff08\u8eab\u4efd\u4ee4\u724c\uff09\u83b7\u53d6\u7528\u6237\u4fe1\u606f\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --POST {server}/connect/userinfo --header Authorization: Bearer ***id_token*** \u54cd\u5e94\u683c\u5f0f \u00b6 { \"permission\" : \"***permission***\" , \"role\" : \"***role***\" , \"preferred_username\" : \"***preferred_username***\" , \"name\" : \"***name***\" , \"sub\" : \"1\" }","title":"\u6df7\u5408\u6a21\u5f0f"},{"location":"auth-hybrid/#_1","text":"\u6df7\u5408\u6a21\u5f0f\uff08hybrid\uff09\u662f\u7b80\u5316\u6a21\u5f0f\u3001\u6388\u6743\u7801\u6a21\u5f0f\u4e24\u8005\u7684\u6df7\u5408\uff0c\u5728\u8be5\u6d41\u7a0b\u91cc\uff0c\u6709\u4e00\u4e9bTokens\u548c\u6388\u6743\u7801\u6765\u81ea\u4e8e\u6388\u6743\u91cd\u70b9\uff0c\u800c\u53e6\u5916\u4e00\u4e9bTokens\u5219\u6765\u81ea\u4e8eToken\u7aef\u70b9\u3002\u8be5\u6d41\u7a0b\u5141\u8bb8\u5ba2\u6237\u7aef\u7acb\u5373\u4f7f\u7528ID Token\uff0c\u5e76\u4e14\u53ea\u9700\u8981\u4e00\u6b21\u5f80\u8fd4\u5373\u53ef\u83b7\u5f97\u6388\u6743\u7801\u3002","title":"\u6df7\u5408\u6a21\u5f0f"},{"location":"auth-hybrid/#_2","text":"\u5ba2\u6237\u7aef\u5e94\u7528\u53ef\u4ee5\u5b89\u5168\u7684\u7ef4\u62a4Secret\uff0c\u5b83\u4e5f\u9002\u5408\u4e8e\u957f\u65f6\u95f4\u7684\u8bbf\u95ee\u3002","title":"\u9002\u7528\u573a\u666f"},{"location":"auth-hybrid/#_3","text":"","title":"\u4f7f\u7528\u8bf4\u660e"},{"location":"auth-hybrid/#1","text":"\u5f53\u4f7f\u7528Client\u53d1\u8d77\u4e00\u4e2a\u6388\u6743\u7801\u6a21\u5f0f\u8bf7\u6c42\u65f6\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --GET {server}/connect/authorize?response_type=id_token code&client_id={client_id}&redirect_uri={redirect_uri}&scope={scope}&nonce={nonce}","title":"1\uff0c\u83b7\u53d6\u6388\u6743\u7801\u548c\u6807\u8bc6\u4ee4\u724c"},{"location":"auth-hybrid/#_4","text":"\u540d\u79f0 \u662f\u5426\u5fc5\u987b \u8bf4\u660e response_type \u662f \u56fa\u5b9a\u4f20id_token code client_id \u662f \u5e94\u7528\u7684ID redirect_uri \u662f \u56de\u8c03\u5730\u5740 scope \u662f \u7533\u8bf7\u6388\u6743\u7684 scope \uff0c\u591a\u4e2ascope\u7528\u7a7a\u683c\u5206\u9694\u3002 nonce \u662f \u968f\u673a\u5b57\u7b26\u4e32","title":"\u53c2\u6570\u8bf4\u660e"},{"location":"auth-hybrid/#_5","text":"\u5f53\u7528\u6237\u6388\u6743\u6210\u529f\u540e\uff0c\u670d\u52a1\u5668\u4f1a\u5c06\u6388\u6743\u7801\u548c\u8eab\u4efd\u4ee4\u724c\u4e00\u8d77\u56de\u4f20\u5230\u56de\u8c03\u5730\u5740\uff1a {redirect_uri}?code= ***code*** &id_token= ***id_token***","title":"\u54cd\u5e94\u683c\u5f0f"},{"location":"auth-hybrid/#2accesstoken","text":"\u901a\u8fc7code\uff08\u6388\u6743\u7801\uff09\u6362\u53d6AccessToken\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --POST {server}/connect/token","title":"2\uff0c\u83b7\u53d6AccessToken"},{"location":"auth-hybrid/#_6","text":"\u540d\u79f0 \u662f\u5426\u5fc5\u987b \u8bf4\u660e grant_type \u662f \u6388\u6743\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u4e3a code id_token \u3001 code token \u3001 code id_token token code \u662f \u6b65\u9aa41\u8fd4\u56de\u7684\u6388\u6743\u7801 client_id \u662f \u5e94\u7528\u7684ID client_secret \u662f \u5e94\u7528\u7684\u5bc6\u94a5 scope \u662f \u8868\u793a\u6388\u6743\u8303\u56f4\uff0c\u591a\u4e2a scope \u7528\u7a7a\u683c\u5206\u9694\u3002 redirect_uri \u662f \u4e0e\u6b65\u9aa41\u7684\u56de\u8c03\u5730\u5740\u4fdd\u6301\u4e00\u81f4","title":"\u53c2\u6570\u8bf4\u660e"},{"location":"auth-hybrid/#_7","text":"{ \"access_token\" : \"***AccessToken***\" , \"expires_in\" : 3600 , \"token_type\" : \"Bearer\" , \"scope\" : \"***scopes***\" }","title":"\u54cd\u5e94\u683c\u5f0f"},{"location":"auth-hybrid/#3","text":"\u901a\u8fc7id_token\uff08\u8eab\u4efd\u4ee4\u724c\uff09\u83b7\u53d6\u7528\u6237\u4fe1\u606f\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --POST {server}/connect/userinfo --header Authorization: Bearer ***id_token***","title":"3\uff0c\u83b7\u53d6\u7528\u6237\u4fe1\u606f"},{"location":"auth-hybrid/#_8","text":"{ \"permission\" : \"***permission***\" , \"role\" : \"***role***\" , \"preferred_username\" : \"***preferred_username***\" , \"name\" : \"***name***\" , \"sub\" : \"1\" }","title":"\u54cd\u5e94\u683c\u5f0f"},{"location":"auth-implicit/","text":"\u7b80\u5316\u6a21\u5f0f \u00b6 \u9690\u5f0f\u6388\u6743\u6a21\u5f0f/\u7b80\u5316\u6a21\u5f0f\uff08implicit\uff09\u548c\u6388\u6743\u7801\u6a21\u5f0f\u7c7b\u4f3c\uff0c\u53ea\u4e0d\u8fc7\u5c11\u4e86\u83b7\u53d6code\u7684\u6b65\u9aa4\uff0c\u662f\u76f4\u63a5\u83b7\u53d6\u4ee4\u724ctoken\u7684\uff0c\u9002\u7528\u4e8e\u516c\u5f00\u7684\u6d4f\u89c8\u5668\u5355\u9875\u5e94\u7528\uff0c\u4ee4\u724c\u76f4\u63a5\u4ece\u6388\u6743\u670d\u52a1\u5668\u8fd4\u56de\uff0c\u4e0d\u652f\u6301\u5237\u65b0\u4ee4\u724c\uff0c\u4e14\u6ca1\u6709code\u5b89\u5168\u4fdd\u8bc1\uff0c\u4ee4\u724c\u5bb9\u6613\u56e0\u4e3a\u88ab\u62e6\u622a\u7a83\u542c\u800c\u6cc4\u9732\u3002 \u9002\u7528\u573a\u666f \u00b6 \u7b2c\u4e09\u65b9\u5355\u9875\u9762\u5e94\u7528\u3002 \u4f7f\u7528\u8bf4\u660e \u00b6 \u83b7\u53d6AccessToken \u00b6 \u5f53\u4f7f\u7528Client\u53d1\u8d77\u4e00\u4e2a\u7b80\u5316\u6388\u6743\u8bf7\u6c42\u65f6\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --GET {server}/connect/authorize?response_type=token&client_id={client_id}&redirect_uri={redirect_uri}&scope={scope}&nonce={nonce} \u53c2\u6570\u8bf4\u660e \u00b6 \u540d\u79f0 \u662f\u5426\u5fc5\u987b \u8bf4\u660e response_type \u662f \u6388\u6743\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u4e3a id_token token client_id \u662f \u5e94\u7528\u7684ID redirect_uri \u662f \u56de\u8c03\u5730\u5740 scope \u662f \u8868\u793a\u6388\u6743\u8303\u56f4\uff0c\u591a\u4e2a scope \u7528\u7a7a\u683c\u5206\u9694\u3002 nonce \u662f \u968f\u673a\u5b57\u7b26\u4e32 \u54cd\u5e94\u683c\u5f0f \u00b6 \u5f53\u7528\u6237\u6388\u6743\u6210\u529f\u540e\uff0c\u670d\u52a1\u5668\u4f1a\u5c06access_token\u76f8\u5173\u4fe1\u606f\u4e00\u8d77\u56de\u4f20\u5230\u56de\u8c03\u5730\u5740\uff1a {redirect_uri}?access_token= ***access_token*** &token_type=bearer&expires_in=3600&scope= ***scopes***","title":"\u7b80\u5316\u6a21\u5f0f"},{"location":"auth-implicit/#_1","text":"\u9690\u5f0f\u6388\u6743\u6a21\u5f0f/\u7b80\u5316\u6a21\u5f0f\uff08implicit\uff09\u548c\u6388\u6743\u7801\u6a21\u5f0f\u7c7b\u4f3c\uff0c\u53ea\u4e0d\u8fc7\u5c11\u4e86\u83b7\u53d6code\u7684\u6b65\u9aa4\uff0c\u662f\u76f4\u63a5\u83b7\u53d6\u4ee4\u724ctoken\u7684\uff0c\u9002\u7528\u4e8e\u516c\u5f00\u7684\u6d4f\u89c8\u5668\u5355\u9875\u5e94\u7528\uff0c\u4ee4\u724c\u76f4\u63a5\u4ece\u6388\u6743\u670d\u52a1\u5668\u8fd4\u56de\uff0c\u4e0d\u652f\u6301\u5237\u65b0\u4ee4\u724c\uff0c\u4e14\u6ca1\u6709code\u5b89\u5168\u4fdd\u8bc1\uff0c\u4ee4\u724c\u5bb9\u6613\u56e0\u4e3a\u88ab\u62e6\u622a\u7a83\u542c\u800c\u6cc4\u9732\u3002","title":"\u7b80\u5316\u6a21\u5f0f"},{"location":"auth-implicit/#_2","text":"\u7b2c\u4e09\u65b9\u5355\u9875\u9762\u5e94\u7528\u3002","title":"\u9002\u7528\u573a\u666f"},{"location":"auth-implicit/#_3","text":"","title":"\u4f7f\u7528\u8bf4\u660e"},{"location":"auth-implicit/#accesstoken","text":"\u5f53\u4f7f\u7528Client\u53d1\u8d77\u4e00\u4e2a\u7b80\u5316\u6388\u6743\u8bf7\u6c42\u65f6\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --GET {server}/connect/authorize?response_type=token&client_id={client_id}&redirect_uri={redirect_uri}&scope={scope}&nonce={nonce}","title":"\u83b7\u53d6AccessToken"},{"location":"auth-implicit/#_4","text":"\u540d\u79f0 \u662f\u5426\u5fc5\u987b \u8bf4\u660e response_type \u662f \u6388\u6743\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u4e3a id_token token client_id \u662f \u5e94\u7528\u7684ID redirect_uri \u662f \u56de\u8c03\u5730\u5740 scope \u662f \u8868\u793a\u6388\u6743\u8303\u56f4\uff0c\u591a\u4e2a scope \u7528\u7a7a\u683c\u5206\u9694\u3002 nonce \u662f \u968f\u673a\u5b57\u7b26\u4e32","title":"\u53c2\u6570\u8bf4\u660e"},{"location":"auth-implicit/#_5","text":"\u5f53\u7528\u6237\u6388\u6743\u6210\u529f\u540e\uff0c\u670d\u52a1\u5668\u4f1a\u5c06access_token\u76f8\u5173\u4fe1\u606f\u4e00\u8d77\u56de\u4f20\u5230\u56de\u8c03\u5730\u5740\uff1a {redirect_uri}?access_token= ***access_token*** &token_type=bearer&expires_in=3600&scope= ***scopes***","title":"\u54cd\u5e94\u683c\u5f0f"},{"location":"auth-password/","text":"\u5bc6\u7801\u6a21\u5f0f \u00b6 \u5bc6\u7801\u6a21\u5f0f\uff08password\uff09\u4f7f\u7528\u7528\u6237\u540d/\u5bc6\u7801\u4f5c\u4e3a\u6388\u6743\u65b9\u5f0f\u4ece\u6388\u6743\u670d\u52a1\u5668\u4e0a\u83b7\u53d6\u4ee4\u724c\uff0c\u4e00\u822c\u4e0d\u652f\u6301\u5237\u65b0\u4ee4\u724c\u3002 \u9002\u7528\u573a\u666f \u00b6 \u7b2c\u4e00\u65b9\u5355\u9875\u5e94\u7528\u4e0e\u7b2c\u4e00\u65b9\u539f\u751fApp\u3002 \u4f7f\u7528\u8bf4\u660e \u00b6 \u83b7\u53d6AccessToken \u00b6 \u5f53\u4f7f\u7528Client\u53d1\u8d77\u4e00\u4e2a\u5bc6\u7801\u6a21\u5f0f\u8bf7\u6c42\u65f6\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --POST {server}/connect/token \u53c2\u6570\u8bf4\u660e \u00b6 \u540d\u79f0 \u662f\u5426\u5fc5\u987b \u8bf4\u660e grant_type \u662f \u6388\u6743\u7c7b\u578b\uff0c\u503c\u56fa\u5b9a\u4e3a password client_id \u662f \u5e94\u7528\u7684ID client_secret \u662f \u5e94\u7528\u7684\u5bc6\u94a5 username \u662f \u7528\u6237\u7684\u767b\u5f55\u8d26\u53f7 password \u662f \u7528\u6237\u7684\u767b\u5f55\u5bc6\u7801 scope \u662f \u8868\u793a\u6388\u6743\u8303\u56f4\uff0c\u591a\u4e2a scope \u7528\u7a7a\u683c\u5206\u9694\u3002 \u54cd\u5e94\u683c\u5f0f \u00b6 { \"access_token\" : \"***AccessToken***\" , \"expires_in\" : 3600 , \"token_type\" : \"Bearer\" , \"scope\" : \"***scopes***\" }","title":"\u5bc6\u7801\u6a21\u5f0f"},{"location":"auth-password/#_1","text":"\u5bc6\u7801\u6a21\u5f0f\uff08password\uff09\u4f7f\u7528\u7528\u6237\u540d/\u5bc6\u7801\u4f5c\u4e3a\u6388\u6743\u65b9\u5f0f\u4ece\u6388\u6743\u670d\u52a1\u5668\u4e0a\u83b7\u53d6\u4ee4\u724c\uff0c\u4e00\u822c\u4e0d\u652f\u6301\u5237\u65b0\u4ee4\u724c\u3002","title":"\u5bc6\u7801\u6a21\u5f0f"},{"location":"auth-password/#_2","text":"\u7b2c\u4e00\u65b9\u5355\u9875\u5e94\u7528\u4e0e\u7b2c\u4e00\u65b9\u539f\u751fApp\u3002","title":"\u9002\u7528\u573a\u666f"},{"location":"auth-password/#_3","text":"","title":"\u4f7f\u7528\u8bf4\u660e"},{"location":"auth-password/#accesstoken","text":"\u5f53\u4f7f\u7528Client\u53d1\u8d77\u4e00\u4e2a\u5bc6\u7801\u6a21\u5f0f\u8bf7\u6c42\u65f6\uff0c\u6807\u51c6\u7684\u8bf7\u6c42\u5730\u5740\u662f\uff1a --POST {server}/connect/token","title":"\u83b7\u53d6AccessToken"},{"location":"auth-password/#_4","text":"\u540d\u79f0 \u662f\u5426\u5fc5\u987b \u8bf4\u660e grant_type \u662f \u6388\u6743\u7c7b\u578b\uff0c\u503c\u56fa\u5b9a\u4e3a password client_id \u662f \u5e94\u7528\u7684ID client_secret \u662f \u5e94\u7528\u7684\u5bc6\u94a5 username \u662f \u7528\u6237\u7684\u767b\u5f55\u8d26\u53f7 password \u662f \u7528\u6237\u7684\u767b\u5f55\u5bc6\u7801 scope \u662f \u8868\u793a\u6388\u6743\u8303\u56f4\uff0c\u591a\u4e2a scope \u7528\u7a7a\u683c\u5206\u9694\u3002","title":"\u53c2\u6570\u8bf4\u660e"},{"location":"auth-password/#_5","text":"{ \"access_token\" : \"***AccessToken***\" , \"expires_in\" : 3600 , \"token_type\" : \"Bearer\" , \"scope\" : \"***scopes***\" }","title":"\u54cd\u5e94\u683c\u5f0f"},{"location":"authlogins/","text":"\u5bf9\u63a5\u7b2c\u4e09\u65b9OAuth\u5e94\u7528 \u00b6 \u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u79df\u6237\u7684\u7ad9\u70b9\u542f\u7528\u7b2c\u4e09\u65b9\u767b\u5f55\u529f\u80fd\uff0c\u76ee\u524d\u652f\u6301\u7684\u5e73\u53f0\u5982\u4e0b \u5e73\u53f0 \u5c5e\u6027\u540d \u5fae\u4fe1 Weixin: ClientId\u3001Weixin: ClientSecret \u5fae\u535a Weibo: ClientId\u3001Weibo: ClientSecret QQ QQ: ClientId\u3001QQ: ClientSecret MicrosoftAccount Microsoft: ClientId\u3001Microsoft: ClientSecret Google Google: ClientId\u3001Google: ClientSecret Facebook Facebook: ClientId\u3001Facebook: ClientSecret GitHub GitHub: ClientId\u3001GitHub: ClientSecret \u4f7f\u7528\u8bf4\u660e \u00b6 \u914d\u7f6e\u5fae\u4fe1\u767b\u5f55 \u00b6 \u53c2\u8003\u5982\u4e0b\u4ee3\u7801\uff0c\u4e3a\u79df\u6237\u6dfb\u52a0\u5fae\u4fe1\u767b\u5f55\u914d\u7f6e TenantController.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 public class TenantController : ApiControllerBase { private readonly TenantDbContext _tenantDb ; public TenantController ( TenantDbContext tenantDb ) { _tenantDb = tenantDb ; var tenantItem = new AppTenant () { Name = \"OAuthapp\" , Description = \"Test\" }; tenantItem . Properties . Add ( new AppTenantProperty () { Key = \"Weixin:ClientId\" , Value = \"11111\" }); tenantItem . Properties . Add ( new AppTenantProperty () { Key = \"Weixin:ClientSecret\" , Value = \"11111\" }); _tenantDb . Tenants . Add ( tenantItem ); tenantDb . SaveChanges (); } } \u5728\u524d\u7aef\u9875\u9762\u4f7f\u7528 \u00b6 \u53c2\u8003\u5982\u4e0b\u4ee3\u7801\uff0c\u5728\u754c\u9762\u4e2d\u5c55\u793a\u5fae\u4fe1\u767b\u9646 Controllers/LoginController.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 public class LoginController : Controller { private readonly SignInManager < AppUser > _signInManager ; public LoginController ( SignInManager < AppUser > signInManager ) { _signInManager = signInManager ; } [HttpGet] public async Task < IActionResult > Index ( string returnUrl ) { var vm = ( await _signInManager . GetExternalAuthenticationSchemesAsync ()). ToList (); return View ( \"Index\" , vm ); } [HttpPost] public IActionResult Post ( string provider , string returnUrl = null ) { var redirectUrl = Url . Page ( \"./Post\" , pageHandler : \"Callback\" , values : new { returnUrl }); var properties = _signInManager . ConfigureExternalAuthenticationProperties ( provider , redirectUrl ); return new ChallengeResult ( provider , properties ); } } Views/Login/Index.cshtml 1 2 3 4 5 6 7 8 @ { < form method = \"post\" > @foreach ( var provider in Model . ExternalLogins ) { < button type = \"submit\" name = \"provider\" value = \"@provider.Name\" > @provider . DisplayName </ button > } </ form > }","title":"\u5bf9\u63a5\u7b2c\u4e09\u65b9OAuth\u5e94\u7528"},{"location":"authlogins/#oauth","text":"\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u79df\u6237\u7684\u7ad9\u70b9\u542f\u7528\u7b2c\u4e09\u65b9\u767b\u5f55\u529f\u80fd\uff0c\u76ee\u524d\u652f\u6301\u7684\u5e73\u53f0\u5982\u4e0b \u5e73\u53f0 \u5c5e\u6027\u540d \u5fae\u4fe1 Weixin: ClientId\u3001Weixin: ClientSecret \u5fae\u535a Weibo: ClientId\u3001Weibo: ClientSecret QQ QQ: ClientId\u3001QQ: ClientSecret MicrosoftAccount Microsoft: ClientId\u3001Microsoft: ClientSecret Google Google: ClientId\u3001Google: ClientSecret Facebook Facebook: ClientId\u3001Facebook: ClientSecret GitHub GitHub: ClientId\u3001GitHub: ClientSecret","title":"\u5bf9\u63a5\u7b2c\u4e09\u65b9OAuth\u5e94\u7528"},{"location":"authlogins/#_1","text":"","title":"\u4f7f\u7528\u8bf4\u660e"},{"location":"authlogins/#_2","text":"\u53c2\u8003\u5982\u4e0b\u4ee3\u7801\uff0c\u4e3a\u79df\u6237\u6dfb\u52a0\u5fae\u4fe1\u767b\u5f55\u914d\u7f6e TenantController.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 public class TenantController : ApiControllerBase { private readonly TenantDbContext _tenantDb ; public TenantController ( TenantDbContext tenantDb ) { _tenantDb = tenantDb ; var tenantItem = new AppTenant () { Name = \"OAuthapp\" , Description = \"Test\" }; tenantItem . Properties . Add ( new AppTenantProperty () { Key = \"Weixin:ClientId\" , Value = \"11111\" }); tenantItem . Properties . Add ( new AppTenantProperty () { Key = \"Weixin:ClientSecret\" , Value = \"11111\" }); _tenantDb . Tenants . Add ( tenantItem ); tenantDb . SaveChanges (); } }","title":"\u914d\u7f6e\u5fae\u4fe1\u767b\u5f55"},{"location":"authlogins/#_3","text":"\u53c2\u8003\u5982\u4e0b\u4ee3\u7801\uff0c\u5728\u754c\u9762\u4e2d\u5c55\u793a\u5fae\u4fe1\u767b\u9646 Controllers/LoginController.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 public class LoginController : Controller { private readonly SignInManager < AppUser > _signInManager ; public LoginController ( SignInManager < AppUser > signInManager ) { _signInManager = signInManager ; } [HttpGet] public async Task < IActionResult > Index ( string returnUrl ) { var vm = ( await _signInManager . GetExternalAuthenticationSchemesAsync ()). ToList (); return View ( \"Index\" , vm ); } [HttpPost] public IActionResult Post ( string provider , string returnUrl = null ) { var redirectUrl = Url . Page ( \"./Post\" , pageHandler : \"Callback\" , values : new { returnUrl }); var properties = _signInManager . ConfigureExternalAuthenticationProperties ( provider , redirectUrl ); return new ChallengeResult ( provider , properties ); } } Views/Login/Index.cshtml 1 2 3 4 5 6 7 8 @ { < form method = \"post\" > @foreach ( var provider in Model . ExternalLogins ) { < button type = \"submit\" name = \"provider\" value = \"@provider.Name\" > @provider . DisplayName </ button > } </ form > }","title":"\u5728\u524d\u7aef\u9875\u9762\u4f7f\u7528"},{"location":"azureblob/","text":"\u914d\u7f6e\u5b58\u50a8\u670d\u52a1 \u00b6 Blob\u63a5\u53e3 \u53ef\u5b58\u50a8\u6587\u4ef6\u3001\u56fe\u7247\u3001\u97f3\u89c6\u9891\u7b49\uff0c\u9700\u8981\u5f00\u901a Azure Storage \u670d\u52a1 \u5e76\u590d\u5236\u8fde\u63a5\u5bc6\u94a5\u5230\u5982\u4e0b\u914d\u7f6e\u4e2d\u3002 appsettings.json 1 2 3 \"ConnectionStrings\" : { \"AzureStorageConnection\" : \"\u8fde\u63a5\u5b57\u7b26\u4e32\" }","title":"\u914d\u7f6e\u5b58\u50a8\u670d\u52a1"},{"location":"azureblob/#_1","text":"Blob\u63a5\u53e3 \u53ef\u5b58\u50a8\u6587\u4ef6\u3001\u56fe\u7247\u3001\u97f3\u89c6\u9891\u7b49\uff0c\u9700\u8981\u5f00\u901a Azure Storage \u670d\u52a1 \u5e76\u590d\u5236\u8fde\u63a5\u5bc6\u94a5\u5230\u5982\u4e0b\u914d\u7f6e\u4e2d\u3002 appsettings.json 1 2 3 \"ConnectionStrings\" : { \"AzureStorageConnection\" : \"\u8fde\u63a5\u5b57\u7b26\u4e32\" }","title":"\u914d\u7f6e\u5b58\u50a8\u670d\u52a1"},{"location":"doc-extensions/","text":"ReDoc vendor extensions \u00b6 You can use the following vendor extensions with Redoc. Swagger Object x-servers x-tagGroups Tag Group Object x-ignoredHeaderParameters Info Object x-logo Logo Object Tag Object x-traitTag x-displayName Operation Object x-codeSamples Code Sample Object Parameter Object x-examples Response Object vendor extensions x-summary Schema Object x-nullable x-extendedDiscriminator x-additionalPropertiesName x-explicitMappingOnly Swagger Object \u00b6 Extends the OpenAPI root OpenAPI Object x-servers \u00b6 Backported from OpenAPI 3.0 servers . Currently doesn't support templates. x-tagGroups \u00b6 Field Name Type Description x-tagGroups [ Tag Group Object ] A list of tag groups How to use with Redoc \u00b6 x-tagGroups is used to group tags in the side menu. Before you use x-tagGroups , make sure you add all tags to a group , since a tag that is not in a group, will not be displayed at all! Tag Group Object \u00b6 Information about tags group Fixed fields \u00b6 Field Name Type Description name string The group name tags [ string ] List of tags to include in this group x-tagGroups example \u00b6 json { \"x-tagGroups\" : [ { \"name\" : \"User Management\" , \"tags\" : [ \"Users\" , \"API keys\" , \"Admin\" ] }, { \"name\" : \"Statistics\" , \"tags\" : [ \"Main Stats\" , \"Secondary Stats\" ] } ] } yaml x-tagGroups : - name : User Management tags : - Users - API keys - Admin - name : Statistics tags : - Main Stats - Secondary Stats x-ignoredHeaderParameters \u00b6 Field Name Type Description x-ignoredHeaderParameters [ string ] A list of ignored headers How to use with Redoc \u00b6 Use x-ignoredHeaderParameters to specify header parameter names which are ignored by ReDoc. x-ignoredHeaderParameters example \u00b6 swagger : '2.0' info : ... tags : [ ... ] x-ignoredHeaderParameters : - Accept - User-Agent - X-Test-Header Info Object \u00b6 Extends the OpenAPI Info Object x-logo \u00b6 Field Name Type Description x-logo Logo Object The information about API logo How to use with Redoc \u00b6 x-logo is used to specify API logo. The corresponding image is displayed just above the side-menu. Logo Object \u00b6 The information about API logo Fixed fields \u00b6 Field Name Type Description url string The URL pointing to the spec logo. MUST be in the format of a URL. It SHOULD be an absolute URL so your API definition is usable from any location backgroundColor string background color to be used. MUST be RGB color in [hexadecimal format] ( https://en.wikipedia.org/wiki/Web_colors#Hex_triplet ) altText string Text to use for alt tag on the logo. Defaults to 'logo' if nothing is provided. href string The URL pointing to the contact page. Default to 'info.contact.url' field of the OAS. x-logo example \u00b6 json { \"info\" : { \"version\" : \"1.0.0\" , \"title\" : \"Swagger Petstore\" , \"x-logo\" : { \"url\" : \"https://redocly.github.io/redoc/petstore-logo.png\" , \"backgroundColor\" : \"#FFFFFF\" , \"altText\" : \"Petstore logo\" } } } yaml info : version : \"1.0.0\" title : \"Swagger Petstore\" x-logo : url : \"https://redocly.github.io/redoc/petstore-logo.png\" backgroundColor : \"#FFFFFF\" altText : \"Petstore logo\" Tag Object \u00b6 Extends the OpenAPI Tag Object x-traitTag \u00b6 Field Name Type Description x-traitTag boolean In Swagger two operations can have multiple tags. This property distinguishes between tags that are used to group operations (default) from tags that are used to mark operation with certain trait ( true value) How to use with Redoc \u00b6 Tags that have x-traitTag set to true are listed in the side-menu but don't have any subitems (operations). It also renders the description tag. This is useful for handling out common things like Pagination, Rate-Limits, etc. x-traitTag example \u00b6 json { \"name\" : \"Pagination\" , \"description\" : \"Pagination description (can use markdown syntax)\" , \"x-traitTag\" : true } yaml name : Pagination description : Pagination description (can use markdown syntax) x-traitTag : true x-displayName \u00b6 Field Name Type Description x-displayName string Defines the text that is used for this tag in the menu and in section headings Operation Object vendor extensions \u00b6 Extends the OpenAPI Operation Object x-codeSamples \u00b6 Field Name Type Description x-codeSamples [ Code Sample Object ] A list of code samples associated with operation How to use with ReDoc \u00b6 x-codeSamples are rendered on the right panel in ReDoc. Code Sample Object \u00b6 Operation code sample Fixed fields \u00b6 Field Name Type Description lang string Code sample language. Value should be one of the following list label string? Code sample label e.g. Node or Python2.7 , optional , lang will be used by default source string Code sample source code Code Sample Object example \u00b6 json { \"lang\" : \"JavaScript\" , \"source\" : \"console.log('Hello World');\" } yaml lang : JavaScript source : console.log('Hello World'); Parameter Object \u00b6 Extends the OpenAPI Parameter Object x-examples \u00b6 Field Name Type Description x-examples Example Object Object that contains examples for the request. Applies when in is body and mime-type is application/json How to use with ReDoc \u00b6 x-examples are rendered in the JSON tab on the right panel in ReDoc. Response Object vendor extensions \u00b6 Extends the OpenAPI Response Object x-summary \u00b6 Field Name Type Description x-summary string a short summary of the response How to use with ReDoc \u00b6 If specified, you can use x-summary as the response button text, with description rendered under the button. Schema Object \u00b6 Extends the OpenAPI Schema Object x-nullable \u00b6 Field Name Type Description x-nullable boolean marks schema as a nullable How to use with ReDoc \u00b6 Schemas marked as x-nullable are marked in ReDoc with the label Nullable x-extendedDiscriminator \u00b6 ATTENTION : This is a ReDoc-specific vendor extension, and is not supported by other tools. Field Name Type Description x-extendedDiscriminator string specifies extended discriminator How to use with ReDoc \u00b6 ReDoc uses this vendor extension to solve name-clash issues with the standard discriminator . Value of this field specifies the field which will be used as a extended discriminator. ReDoc displays definition with selectpicker using which user can select value of the x-extendedDiscriminator -marked field. ReDoc displays the definition derived from the current (using allOf ) and has enum with only one value which is the same as the selected value of the field specified as x-extendedDiscriminator . x-extendedDiscriminator example \u00b6 Payment : x-extendedDiscriminator : type type : object required : - type properties : type : type : string name : type : string CashPayment : allOf : - $ref : \"#/definitions/Payment\" - properties : type : type : string enum : - cash currency : type : string PayPalPayment : allOf : - $ref : \"#/definitions/Payment\" - properties : type : type : string enum : - paypal userEmail : type : string In the example above, the names of definitions ( PayPalPayment ) are named differently than names in the payload ( paypal ) which is not supported by default discriminator . x-additionalPropertiesName \u00b6 ATTENTION : This is a ReDoc-specific vendor extension, and is not supported by other tools. Extends the additionalProperties property of the schema object. Field Name Type Description x-additionalPropertiesName string descriptive name of additional properties keys How to use with ReDoc \u00b6 ReDoc uses this extension to display a more descriptive property name in objects with additionalProperties when viewing the property list with an object . x-additionalPropertiesName example \u00b6 Player : required : - name properties : name : type : string additionalProperties : x-additionalPropertiesName : attribute-name type : string x-explicitMappingOnly \u00b6 ATTENTION : This is ReDoc-specific vendor extension, and is not supported by other tools. Extends the discriminator property of the schema object. Field Name Type Description x-explicitMappingOnly boolean limit the discriminator selectpicker to the explicit mappings only How to use with ReDoc \u00b6 ReDoc uses this extension to filter the discriminator mappings shown in the selectpicker. When set to true , the selectpicker will only list the the explicitly defined mappings. When false , the default behavior is kept, i.e. explicit and implicit mappings will be shown. x-explicitMappingOnly example \u00b6 Pet : type : object required : - name - photoUrls discriminator : propertyName : petType x-explicitMappingOnly : true mapping : cat : \"#/components/schemas/Cat\" bee : \"#/components/schemas/HoneyBee\" Will show in the selectpicker only the items cat and bee , even though the Dog class inherits from the Pet class.","title":"ReDoc vendor extensions"},{"location":"doc-extensions/#redoc-vendor-extensions","text":"You can use the following vendor extensions with Redoc. Swagger Object x-servers x-tagGroups Tag Group Object x-ignoredHeaderParameters Info Object x-logo Logo Object Tag Object x-traitTag x-displayName Operation Object x-codeSamples Code Sample Object Parameter Object x-examples Response Object vendor extensions x-summary Schema Object x-nullable x-extendedDiscriminator x-additionalPropertiesName x-explicitMappingOnly","title":"ReDoc vendor extensions"},{"location":"doc-extensions/#swagger-object","text":"Extends the OpenAPI root OpenAPI Object","title":"Swagger Object"},{"location":"doc-extensions/#x-servers","text":"Backported from OpenAPI 3.0 servers . Currently doesn't support templates.","title":"x-servers"},{"location":"doc-extensions/#x-taggroups","text":"Field Name Type Description x-tagGroups [ Tag Group Object ] A list of tag groups","title":"x-tagGroups"},{"location":"doc-extensions/#how-to-use-with-redoc","text":"x-tagGroups is used to group tags in the side menu. Before you use x-tagGroups , make sure you add all tags to a group , since a tag that is not in a group, will not be displayed at all!","title":"How to use with Redoc"},{"location":"doc-extensions/#tag-group-object","text":"Information about tags group","title":"Tag Group Object"},{"location":"doc-extensions/#fixed-fields","text":"Field Name Type Description name string The group name tags [ string ] List of tags to include in this group","title":"Fixed fields"},{"location":"doc-extensions/#x-taggroups-example","text":"json { \"x-tagGroups\" : [ { \"name\" : \"User Management\" , \"tags\" : [ \"Users\" , \"API keys\" , \"Admin\" ] }, { \"name\" : \"Statistics\" , \"tags\" : [ \"Main Stats\" , \"Secondary Stats\" ] } ] } yaml x-tagGroups : - name : User Management tags : - Users - API keys - Admin - name : Statistics tags : - Main Stats - Secondary Stats","title":"x-tagGroups example"},{"location":"doc-extensions/#x-ignoredheaderparameters","text":"Field Name Type Description x-ignoredHeaderParameters [ string ] A list of ignored headers","title":"x-ignoredHeaderParameters"},{"location":"doc-extensions/#how-to-use-with-redoc_1","text":"Use x-ignoredHeaderParameters to specify header parameter names which are ignored by ReDoc.","title":"How to use with Redoc"},{"location":"doc-extensions/#x-ignoredheaderparameters-example","text":"swagger : '2.0' info : ... tags : [ ... ] x-ignoredHeaderParameters : - Accept - User-Agent - X-Test-Header","title":"x-ignoredHeaderParameters example"},{"location":"doc-extensions/#info-object","text":"Extends the OpenAPI Info Object","title":"Info Object"},{"location":"doc-extensions/#x-logo","text":"Field Name Type Description x-logo Logo Object The information about API logo","title":"x-logo"},{"location":"doc-extensions/#how-to-use-with-redoc_2","text":"x-logo is used to specify API logo. The corresponding image is displayed just above the side-menu.","title":"How to use with Redoc"},{"location":"doc-extensions/#logo-object","text":"The information about API logo","title":"Logo Object"},{"location":"doc-extensions/#fixed-fields_1","text":"Field Name Type Description url string The URL pointing to the spec logo. MUST be in the format of a URL. It SHOULD be an absolute URL so your API definition is usable from any location backgroundColor string background color to be used. MUST be RGB color in [hexadecimal format] ( https://en.wikipedia.org/wiki/Web_colors#Hex_triplet ) altText string Text to use for alt tag on the logo. Defaults to 'logo' if nothing is provided. href string The URL pointing to the contact page. Default to 'info.contact.url' field of the OAS.","title":"Fixed fields"},{"location":"doc-extensions/#x-logo-example","text":"json { \"info\" : { \"version\" : \"1.0.0\" , \"title\" : \"Swagger Petstore\" , \"x-logo\" : { \"url\" : \"https://redocly.github.io/redoc/petstore-logo.png\" , \"backgroundColor\" : \"#FFFFFF\" , \"altText\" : \"Petstore logo\" } } } yaml info : version : \"1.0.0\" title : \"Swagger Petstore\" x-logo : url : \"https://redocly.github.io/redoc/petstore-logo.png\" backgroundColor : \"#FFFFFF\" altText : \"Petstore logo\"","title":"x-logo example"},{"location":"doc-extensions/#tag-object","text":"Extends the OpenAPI Tag Object","title":"Tag Object"},{"location":"doc-extensions/#x-traittag","text":"Field Name Type Description x-traitTag boolean In Swagger two operations can have multiple tags. This property distinguishes between tags that are used to group operations (default) from tags that are used to mark operation with certain trait ( true value)","title":"x-traitTag"},{"location":"doc-extensions/#how-to-use-with-redoc_3","text":"Tags that have x-traitTag set to true are listed in the side-menu but don't have any subitems (operations). It also renders the description tag. This is useful for handling out common things like Pagination, Rate-Limits, etc.","title":"How to use with Redoc"},{"location":"doc-extensions/#x-traittag-example","text":"json { \"name\" : \"Pagination\" , \"description\" : \"Pagination description (can use markdown syntax)\" , \"x-traitTag\" : true } yaml name : Pagination description : Pagination description (can use markdown syntax) x-traitTag : true","title":"x-traitTag example"},{"location":"doc-extensions/#x-displayname","text":"Field Name Type Description x-displayName string Defines the text that is used for this tag in the menu and in section headings","title":"x-displayName"},{"location":"doc-extensions/#operation-object-vendor-extensions","text":"Extends the OpenAPI Operation Object","title":"Operation Object vendor extensions"},{"location":"doc-extensions/#x-codesamples","text":"Field Name Type Description x-codeSamples [ Code Sample Object ] A list of code samples associated with operation","title":"x-codeSamples"},{"location":"doc-extensions/#how-to-use-with-redoc_4","text":"x-codeSamples are rendered on the right panel in ReDoc.","title":"How to use with ReDoc"},{"location":"doc-extensions/#code-sample-object","text":"Operation code sample","title":"Code Sample Object"},{"location":"doc-extensions/#fixed-fields_2","text":"Field Name Type Description lang string Code sample language. Value should be one of the following list label string? Code sample label e.g. Node or Python2.7 , optional , lang will be used by default source string Code sample source code","title":"Fixed fields"},{"location":"doc-extensions/#code-sample-object-example","text":"json { \"lang\" : \"JavaScript\" , \"source\" : \"console.log('Hello World');\" } yaml lang : JavaScript source : console.log('Hello World');","title":"Code Sample Object example"},{"location":"doc-extensions/#parameter-object","text":"Extends the OpenAPI Parameter Object","title":"Parameter Object"},{"location":"doc-extensions/#x-examples","text":"Field Name Type Description x-examples Example Object Object that contains examples for the request. Applies when in is body and mime-type is application/json","title":"x-examples"},{"location":"doc-extensions/#how-to-use-with-redoc_5","text":"x-examples are rendered in the JSON tab on the right panel in ReDoc.","title":"How to use with ReDoc"},{"location":"doc-extensions/#response-object-vendor-extensions","text":"Extends the OpenAPI Response Object","title":"Response Object vendor extensions"},{"location":"doc-extensions/#x-summary","text":"Field Name Type Description x-summary string a short summary of the response","title":"x-summary"},{"location":"doc-extensions/#how-to-use-with-redoc_6","text":"If specified, you can use x-summary as the response button text, with description rendered under the button.","title":"How to use with ReDoc"},{"location":"doc-extensions/#schema-object","text":"Extends the OpenAPI Schema Object","title":"Schema Object"},{"location":"doc-extensions/#x-nullable","text":"Field Name Type Description x-nullable boolean marks schema as a nullable","title":"x-nullable"},{"location":"doc-extensions/#how-to-use-with-redoc_7","text":"Schemas marked as x-nullable are marked in ReDoc with the label Nullable","title":"How to use with ReDoc"},{"location":"doc-extensions/#x-extendeddiscriminator","text":"ATTENTION : This is a ReDoc-specific vendor extension, and is not supported by other tools. Field Name Type Description x-extendedDiscriminator string specifies extended discriminator","title":"x-extendedDiscriminator"},{"location":"doc-extensions/#how-to-use-with-redoc_8","text":"ReDoc uses this vendor extension to solve name-clash issues with the standard discriminator . Value of this field specifies the field which will be used as a extended discriminator. ReDoc displays definition with selectpicker using which user can select value of the x-extendedDiscriminator -marked field. ReDoc displays the definition derived from the current (using allOf ) and has enum with only one value which is the same as the selected value of the field specified as x-extendedDiscriminator .","title":"How to use with ReDoc"},{"location":"doc-extensions/#x-extendeddiscriminator-example","text":"Payment : x-extendedDiscriminator : type type : object required : - type properties : type : type : string name : type : string CashPayment : allOf : - $ref : \"#/definitions/Payment\" - properties : type : type : string enum : - cash currency : type : string PayPalPayment : allOf : - $ref : \"#/definitions/Payment\" - properties : type : type : string enum : - paypal userEmail : type : string In the example above, the names of definitions ( PayPalPayment ) are named differently than names in the payload ( paypal ) which is not supported by default discriminator .","title":"x-extendedDiscriminator example"},{"location":"doc-extensions/#x-additionalpropertiesname","text":"ATTENTION : This is a ReDoc-specific vendor extension, and is not supported by other tools. Extends the additionalProperties property of the schema object. Field Name Type Description x-additionalPropertiesName string descriptive name of additional properties keys","title":"x-additionalPropertiesName"},{"location":"doc-extensions/#how-to-use-with-redoc_9","text":"ReDoc uses this extension to display a more descriptive property name in objects with additionalProperties when viewing the property list with an object .","title":"How to use with ReDoc"},{"location":"doc-extensions/#x-additionalpropertiesname-example","text":"Player : required : - name properties : name : type : string additionalProperties : x-additionalPropertiesName : attribute-name type : string","title":"x-additionalPropertiesName example"},{"location":"doc-extensions/#x-explicitmappingonly","text":"ATTENTION : This is ReDoc-specific vendor extension, and is not supported by other tools. Extends the discriminator property of the schema object. Field Name Type Description x-explicitMappingOnly boolean limit the discriminator selectpicker to the explicit mappings only","title":"x-explicitMappingOnly"},{"location":"doc-extensions/#how-to-use-with-redoc_10","text":"ReDoc uses this extension to filter the discriminator mappings shown in the selectpicker. When set to true , the selectpicker will only list the the explicitly defined mappings. When false , the default behavior is kept, i.e. explicit and implicit mappings will be shown.","title":"How to use with ReDoc"},{"location":"doc-extensions/#x-explicitmappingonly-example","text":"Pet : type : object required : - name - photoUrls discriminator : propertyName : petType x-explicitMappingOnly : true mapping : cat : \"#/components/schemas/Cat\" bee : \"#/components/schemas/HoneyBee\" Will show in the selectpicker only the items cat and bee , even though the Dog class inherits from the Pet class.","title":"x-explicitMappingOnly example"},{"location":"extend-validator/","text":"\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668 \u00b6 \u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668\uff0cDemoGrantValidator\u6f14\u793a\u4e86\u5982\u4f55\u9a8c\u8bc1userName\u548cpassword\uff0c\u7136\u540e\u9881\u53d1accessToken\u7684\u8fc7\u7a0b\u3002 Startup.cs 1 2 3 4 5 6 7 8 9 10 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( x => { x . IdentityServerBuilder = builder => { builder . AddExtensionGrantValidator < DemoGrantValidator >(); }; } } DemoGrantValidator.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 public class DemoGrantValidator : IExtensionGrantValidator { public string GrantType => \"demo\" ; public async Task ValidateAsync ( ExtensionGrantValidationContext context ) { var username = context . Request . Raw . Get ( \"username\" ); var password = context . Request . Raw . Get ( \"password\" ); if ( string . IsNullOrWhiteSpace ( username ) || string . IsNullOrWhiteSpace ( password )) { context . Result = new GrantValidationResult ( TokenRequestErrors . InvalidGrant ); return ; } var extraInfo = new Dictionary < string , object >(); extraInfo . Add ( \"country\" , \"china\" ); extraInfo . Add ( \"hobby\" , \"coding,cooking,running\" ); context . Result = new GrantValidationResult ( subject : \"uid_1\" , authenticationMethod : GrantType , customResponse : extraInfo ); return ; } }","title":"\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668"},{"location":"extend-validator/#_1","text":"\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668\uff0cDemoGrantValidator\u6f14\u793a\u4e86\u5982\u4f55\u9a8c\u8bc1userName\u548cpassword\uff0c\u7136\u540e\u9881\u53d1accessToken\u7684\u8fc7\u7a0b\u3002 Startup.cs 1 2 3 4 5 6 7 8 9 10 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( x => { x . IdentityServerBuilder = builder => { builder . AddExtensionGrantValidator < DemoGrantValidator >(); }; } } DemoGrantValidator.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 public class DemoGrantValidator : IExtensionGrantValidator { public string GrantType => \"demo\" ; public async Task ValidateAsync ( ExtensionGrantValidationContext context ) { var username = context . Request . Raw . Get ( \"username\" ); var password = context . Request . Raw . Get ( \"password\" ); if ( string . IsNullOrWhiteSpace ( username ) || string . IsNullOrWhiteSpace ( password )) { context . Result = new GrantValidationResult ( TokenRequestErrors . InvalidGrant ); return ; } var extraInfo = new Dictionary < string , object >(); extraInfo . Add ( \"country\" , \"china\" ); extraInfo . Add ( \"hobby\" , \"coding,cooking,running\" ); context . Result = new GrantValidationResult ( subject : \"uid_1\" , authenticationMethod : GrantType , customResponse : extraInfo ); return ; } }","title":"\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668"},{"location":"logs/","text":"\u66f4\u65b0\u65e5\u5fd7 \u00b6 2020-12-3 \u00b6 \u5df2\u5220\u9664CodeGenController\uff0c\u6539\u4e3a\u4e86PackageController \u53d6\u6d88\u4e86azure api management \u76f8\u5173\u63a5\u53e3\u529f\u80fd API\u6ce8\u91ca\u66f4\u65b0\u4e3amarkdown\u683c\u5f0f \u52a0\u5165\u4e86redoc\u529f\u80fd \u7528\u6237\u7ba1\u7406\u754c\u9762\u6837\u5f0f\u4f18\u5316 2020-11-23 \u00b6 \u91cd\u6784Package\uff08\u8f6f\u4ef6\u5305\uff09\u6a21\u5757 \u91cd\u6784OAuthApp.Jobs\u8f6f\u4ef6\u5305 2020-9-16 \u00b6 \u53d8\u66f4IdentityServer4.MicroSerive\u9879\u76ee\u540d\u79f0\u4e3aOAuthApp\u3002 Nuget\u53051.0.7\u4ee5\u540e\uff0c\u6240\u6709\u4ee3\u7801\u547d\u540d\u7a7a\u95f4\u5747\u6539\u4e3aOAuthApp\u3002 \u5347\u7ea7\u4e86\u4f9d\u8d56\u7b2c\u4e09\u65b9\u4f9d\u8d56\u5305 2020-3-8 \u00b6 \u5347\u7ea7\u5230.net core 3.0 2018-5-30 \u00b6 \u6dfb\u52a0\u4e86read the docs \u96c6\u6210 2018-5-9 \u00b6 \u6dfb\u52a0\u4e86\u5fae\u670d\u52a1\u6743\u9650\u4ee3\u7801\u67e5\u8be2\u63a5\u53e3","title":"\u66f4\u65b0\u65e5\u5fd7"},{"location":"logs/#_1","text":"","title":"\u66f4\u65b0\u65e5\u5fd7"},{"location":"logs/#2020-12-3","text":"\u5df2\u5220\u9664CodeGenController\uff0c\u6539\u4e3a\u4e86PackageController \u53d6\u6d88\u4e86azure api management \u76f8\u5173\u63a5\u53e3\u529f\u80fd API\u6ce8\u91ca\u66f4\u65b0\u4e3amarkdown\u683c\u5f0f \u52a0\u5165\u4e86redoc\u529f\u80fd \u7528\u6237\u7ba1\u7406\u754c\u9762\u6837\u5f0f\u4f18\u5316","title":"2020-12-3"},{"location":"logs/#2020-11-23","text":"\u91cd\u6784Package\uff08\u8f6f\u4ef6\u5305\uff09\u6a21\u5757 \u91cd\u6784OAuthApp.Jobs\u8f6f\u4ef6\u5305","title":"2020-11-23"},{"location":"logs/#2020-9-16","text":"\u53d8\u66f4IdentityServer4.MicroSerive\u9879\u76ee\u540d\u79f0\u4e3aOAuthApp\u3002 Nuget\u53051.0.7\u4ee5\u540e\uff0c\u6240\u6709\u4ee3\u7801\u547d\u540d\u7a7a\u95f4\u5747\u6539\u4e3aOAuthApp\u3002 \u5347\u7ea7\u4e86\u4f9d\u8d56\u7b2c\u4e09\u65b9\u4f9d\u8d56\u5305","title":"2020-9-16"},{"location":"logs/#2020-3-8","text":"\u5347\u7ea7\u5230.net core 3.0","title":"2020-3-8"},{"location":"logs/#2018-5-30","text":"\u6dfb\u52a0\u4e86read the docs \u96c6\u6210","title":"2018-5-30"},{"location":"logs/#2018-5-9","text":"\u6dfb\u52a0\u4e86\u5fae\u670d\u52a1\u6743\u9650\u4ee3\u7801\u67e5\u8be2\u63a5\u53e3","title":"2018-5-9"},{"location":"oauthappswagger/","text":"Swagger \u00b6","title":"Swagger"},{"location":"oauthappswagger/#swagger","text":"","title":"Swagger"},{"location":"saas/","text":"\u591a\u79df\u6237\u6a21\u5f0f \u00b6 OAuthApp\u4f1a\u6839\u636e\u5f53\u524d\u8bf7\u6c42\u7684\u57df\u540d\u81ea\u52a8\u89e3\u6790\u79df\u6237\u4fe1\u606f\uff0c\u5e76\u9644\u52a0\u5230\u8bf7\u6c42\u4e0a\u4e0b\u6587\u4e2d\u3002 \u914d\u7f6e\u8bf4\u660e \u00b6 \u516c\u7f51\u73af\u5883 \u00b6 \u64cd\u4f5c\u6b65\u9aa4 1\uff0c\u90e8\u7f72OAuthApp\u7a0b\u5e8f\u5230\u5177\u6709\u72ec\u7acbIP\u7684\u4e91\u670d\u52a1\u5668 2\uff0c\u5c061\u4e2a\u5907\u6848\u8fc7\u7684\u57df\u540d\u505a\u6cdb\u89e3\u6790\u5230\u4e91\u670d\u52a1\u5668\uff08\u4f8b\u5982\uff1a *.oauthapp.com CNAME \u5230 \u670d\u52a1\u5668IP \uff09 3\uff0c\u4e0a\u4f20\u652f\u6301\u4e8c\u7ea7\u57df\u540d\u901a\u914d\u7684SSL\u57df\u540d\u8bc1\u4e66\u5230\u670d\u52a1\u5668\uff0c\u786e\u4fdd\u901a\u8fc7\u57df\u540d\u8bbf\u95ee\u5230\u7f51\u7ad9\u90fd\u662fHTTPS\u534f\u8bae \u672c\u5730\u73af\u5883 \u00b6 \u64cd\u4f5c\u6b65\u9aa4 1\uff0c\u672c\u5730\u8fd0\u884cOAuthApp\u7a0b\u5e8f\uff0c\u5e76\u8bb0\u5f55\u8bbf\u95ee\u5730\u5740\uff08\u6bd4\u5982\uff1a127.0.0.1:44391\uff09 2\uff0c\u4fee\u6539 hosts \u6587\u4ef6\uff0c\u6dfb\u52a0\u82e5\u5e72\u4e8c\u7ea7\u57df\u540d\u6620\u5c04\u5230\u672c\u5730OAuthApp\u7684\u670d\u52a1\u5668\u5730\u5740\uff08\u6bd4\u5982\uff1a127.0.0.1:44391\uff09 \u79df\u6237\u7ba1\u7406 \u00b6 \u79df\u6237\u6570\u636e\u5e93 TenantDbContext \u8d1f\u8d23\u7ef4\u62a4\u4e8c\u7ea7\u57df\u540d\u4e0e\u79df\u6237\u5b9e\u4f53\u7684\u5173\u7cfb\uff0c\u53ef\u53c2\u8003\u5982\u4e0b\u4ee3\u7801\u8fdb\u884c\u7ba1\u7406\u3002 TenantController.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 public class TenantController : ApiControllerBase { private readonly TenantDbContext _tenantDb ; public TenantController ( TenantDbContext tenantDb ) { _tenantDb = tenantDb ; } // \u83b7\u53d6\u79df\u6237 public List < AppTenant > Get () { return tenantDb . Tenants . ToList (); } // \u521b\u5efa\u79df\u6237 public bool Post ( AppTenant value ) { tenantDb . Tenants . Add ( value ); tenantDb . SaveChanges (); return true ; } // \u66f4\u65b0\u79df\u6237 public bool Put ( AppTenant value ) { tenantDb . Attach ( value ). State = EntityState . Modified ; tenantDb . SaveChanges (); return true ; } // \u5220\u9664\u79df\u6237 public bool Delete ( long id ) { var item = tenantDb . Tenants . Find ( id ); if ( item != null ) { tenantDb . Tenants . Remove ( item ); tenantDb . SaveChanges (); } return true ; } } \u5f00\u59cb\u4f7f\u7528 \u00b6 \u5728\u8bf7\u6c42\u4e2d\u83b7\u53d6\u5f53\u524d\u79df\u6237\u4fe1\u606f\u5e76\u663e\u793a\u51fa\u6765\u3002 \u5728\u63a7\u5236\u5668\u4f7f\u7528 \u00b6 Controllers/HomeController.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 public class HomeController : ApiControllerBase { public IActionResult Index () { // Tenant_Claims \u7528\u4e8e\u5ba2\u6237\u7aef\u7b49\u975e\u673a\u5bc6\u7684\u573a\u666f\uff0cClaim\u53ef\u5b58\u50a8\u5bf9\u5916\u5f00\u653e\u7684\u6570\u636e ViewBag . Tenant_Claims = Tenant . TenantValidatorHelper . GetTenantWithClaims ( Request . HttpContext ); // Tenant_Properties \u7528\u4e8e\u670d\u52a1\u7aef\u573a\u666f\uff0cProperty\u53ef\u5b58\u50a8\u5bc6\u94a5\u6570\u636e ViewBag . Tenant_Properties = Tenant . TenantValidatorHelper . GetTenantWithProperties ( Request . HttpContext ); return View (); } } \u5728\u89c6\u56fe\u4e2d\u4f7f\u7528 \u00b6 Views/Home/Index.cshtml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 @{ var TenantContext = OAuthApp.Tenant.TenantValidatorHelper.GetTenantWithProperties(Context); } < p > @TenantContext.LogoUri </ p > < p > @TenantContext.Name </ p > < p > @TenantContext.IdentityServerIssuerUri </ p > < p > @TenantContext.OwnerUserId </ p > < p > @TenantContext.Description </ p > < p > @TenantContext.Id </ p > @{ foreach(var item in TenantContext.Properties) { < p > < b > @item.Key </ b > : < span > @item.Value </ span > </ p > } }","title":"\u591a\u79df\u6237\u6a21\u5f0f"},{"location":"saas/#_1","text":"OAuthApp\u4f1a\u6839\u636e\u5f53\u524d\u8bf7\u6c42\u7684\u57df\u540d\u81ea\u52a8\u89e3\u6790\u79df\u6237\u4fe1\u606f\uff0c\u5e76\u9644\u52a0\u5230\u8bf7\u6c42\u4e0a\u4e0b\u6587\u4e2d\u3002","title":"\u591a\u79df\u6237\u6a21\u5f0f"},{"location":"saas/#_2","text":"","title":"\u914d\u7f6e\u8bf4\u660e"},{"location":"saas/#_3","text":"\u64cd\u4f5c\u6b65\u9aa4 1\uff0c\u90e8\u7f72OAuthApp\u7a0b\u5e8f\u5230\u5177\u6709\u72ec\u7acbIP\u7684\u4e91\u670d\u52a1\u5668 2\uff0c\u5c061\u4e2a\u5907\u6848\u8fc7\u7684\u57df\u540d\u505a\u6cdb\u89e3\u6790\u5230\u4e91\u670d\u52a1\u5668\uff08\u4f8b\u5982\uff1a *.oauthapp.com CNAME \u5230 \u670d\u52a1\u5668IP \uff09 3\uff0c\u4e0a\u4f20\u652f\u6301\u4e8c\u7ea7\u57df\u540d\u901a\u914d\u7684SSL\u57df\u540d\u8bc1\u4e66\u5230\u670d\u52a1\u5668\uff0c\u786e\u4fdd\u901a\u8fc7\u57df\u540d\u8bbf\u95ee\u5230\u7f51\u7ad9\u90fd\u662fHTTPS\u534f\u8bae","title":"\u516c\u7f51\u73af\u5883"},{"location":"saas/#_4","text":"\u64cd\u4f5c\u6b65\u9aa4 1\uff0c\u672c\u5730\u8fd0\u884cOAuthApp\u7a0b\u5e8f\uff0c\u5e76\u8bb0\u5f55\u8bbf\u95ee\u5730\u5740\uff08\u6bd4\u5982\uff1a127.0.0.1:44391\uff09 2\uff0c\u4fee\u6539 hosts \u6587\u4ef6\uff0c\u6dfb\u52a0\u82e5\u5e72\u4e8c\u7ea7\u57df\u540d\u6620\u5c04\u5230\u672c\u5730OAuthApp\u7684\u670d\u52a1\u5668\u5730\u5740\uff08\u6bd4\u5982\uff1a127.0.0.1:44391\uff09","title":"\u672c\u5730\u73af\u5883"},{"location":"saas/#_5","text":"\u79df\u6237\u6570\u636e\u5e93 TenantDbContext \u8d1f\u8d23\u7ef4\u62a4\u4e8c\u7ea7\u57df\u540d\u4e0e\u79df\u6237\u5b9e\u4f53\u7684\u5173\u7cfb\uff0c\u53ef\u53c2\u8003\u5982\u4e0b\u4ee3\u7801\u8fdb\u884c\u7ba1\u7406\u3002 TenantController.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 public class TenantController : ApiControllerBase { private readonly TenantDbContext _tenantDb ; public TenantController ( TenantDbContext tenantDb ) { _tenantDb = tenantDb ; } // \u83b7\u53d6\u79df\u6237 public List < AppTenant > Get () { return tenantDb . Tenants . ToList (); } // \u521b\u5efa\u79df\u6237 public bool Post ( AppTenant value ) { tenantDb . Tenants . Add ( value ); tenantDb . SaveChanges (); return true ; } // \u66f4\u65b0\u79df\u6237 public bool Put ( AppTenant value ) { tenantDb . Attach ( value ). State = EntityState . Modified ; tenantDb . SaveChanges (); return true ; } // \u5220\u9664\u79df\u6237 public bool Delete ( long id ) { var item = tenantDb . Tenants . Find ( id ); if ( item != null ) { tenantDb . Tenants . Remove ( item ); tenantDb . SaveChanges (); } return true ; } }","title":"\u79df\u6237\u7ba1\u7406"},{"location":"saas/#_6","text":"\u5728\u8bf7\u6c42\u4e2d\u83b7\u53d6\u5f53\u524d\u79df\u6237\u4fe1\u606f\u5e76\u663e\u793a\u51fa\u6765\u3002","title":"\u5f00\u59cb\u4f7f\u7528"},{"location":"saas/#_7","text":"Controllers/HomeController.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 public class HomeController : ApiControllerBase { public IActionResult Index () { // Tenant_Claims \u7528\u4e8e\u5ba2\u6237\u7aef\u7b49\u975e\u673a\u5bc6\u7684\u573a\u666f\uff0cClaim\u53ef\u5b58\u50a8\u5bf9\u5916\u5f00\u653e\u7684\u6570\u636e ViewBag . Tenant_Claims = Tenant . TenantValidatorHelper . GetTenantWithClaims ( Request . HttpContext ); // Tenant_Properties \u7528\u4e8e\u670d\u52a1\u7aef\u573a\u666f\uff0cProperty\u53ef\u5b58\u50a8\u5bc6\u94a5\u6570\u636e ViewBag . Tenant_Properties = Tenant . TenantValidatorHelper . GetTenantWithProperties ( Request . HttpContext ); return View (); } }","title":"\u5728\u63a7\u5236\u5668\u4f7f\u7528"},{"location":"saas/#_8","text":"Views/Home/Index.cshtml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 @{ var TenantContext = OAuthApp.Tenant.TenantValidatorHelper.GetTenantWithProperties(Context); } < p > @TenantContext.LogoUri </ p > < p > @TenantContext.Name </ p > < p > @TenantContext.IdentityServerIssuerUri </ p > < p > @TenantContext.OwnerUserId </ p > < p > @TenantContext.Description </ p > < p > @TenantContext.Id </ p > @{ foreach(var item in TenantContext.Properties) { < p > < b > @item.Key </ b > : < span > @item.Value </ span > </ p > } }","title":"\u5728\u89c6\u56fe\u4e2d\u4f7f\u7528"},{"location":"scopes/","text":"\u6743\u9650\u7801\u8868 \u00b6 OAuthApp\u5185\u7f6e\u7684\u63a5\u53e3\u6743\u9650\uff0c\u4f7f\u7528Client\u8bf7\u6c42\u7528\u6237\u6388\u6743\u65f6\uff0cscope\u53c2\u6570\u53ef\u53c2\u8003\u4e0b\u9762\u7684code\u3002 \u6807\u8bc6\u6743\u9650 \u00b6 code name openid \u7528\u6237\u7684ID profile \u7528\u6237\u8d44\u6599\u8be6\u60c5 address \u8054\u7cfb\u5730\u5740 email \u90ae\u7bb1\u5730\u5740 phone \u624b\u673a\u53f7 role \u89d2\u8272 permission \u6743\u9650 offline_access \u8131\u673a\u8bbf\u95ee API\u8d44\u6e90 \u00b6 code name oauthapp.apiresource.post \u521b\u5efa oauthapp.apiresource.get \u5217\u8868 oauthapp.apiresource.detail \u8be6\u60c5 oauthapp.apiresource.delete \u5220\u9664 oauthapp.apiresource.put \u66f4\u65b0 oauthapp.apiresource.scopes \u6743\u9650\u4ee3\u7801 oauthapp.apiresource.all \u6240\u6709\u6743\u9650 API\u6743\u9650 \u00b6 code name oauthapp.apiscope.post \u521b\u5efa oauthapp.apiscope.get \u5217\u8868 oauthapp.apiscope.detail \u8be6\u60c5 oauthapp.apiscope.delete \u5220\u9664 oauthapp.apiscope.put \u66f4\u65b0 Blob \u00b6 code name oauthapp.blob.file \u4e0a\u4f20\u89c6\u9891\u6216\u6587\u6863 oauthapp.blob.image \u4e0a\u4f20\u56fe\u7247 oauthapp.blob.base64 \u4f20base64\u683c\u5f0f\u7684png\u56fe\u7247 oauthapp.blob.all \u6240\u6709\u6743\u9650 \u5ba2\u6237\u7aef \u00b6 code name oauthapp.client.put \u66f4\u65b0 oauthapp.client.postsecretkey \u751f\u6210\u5bc6\u94a5 oauthapp.client.post \u521b\u5efa oauthapp.client.issuetoken \u521b\u5efa\u4ee4\u724c oauthapp.client.get \u5217\u8868 oauthapp.client.detail \u8be6\u60c5 oauthapp.client.delete \u5220\u9664 oauthapp.client.all \u6240\u6709\u6743\u9650 \u8f6f\u4ef6\u5305 \u00b6 code name oauthapp.package.get \u8f6f\u4ef6\u5305 - \u5217\u8868 oauthapp.package.detail \u8f6f\u4ef6\u5305 - \u8be6\u60c5 oauthapp.package.post \u8f6f\u4ef6\u5305 - \u521b\u5efa oauthapp.package.put \u8f6f\u4ef6\u5305 - \u66f4\u65b0 oauthapp.package.delete \u8f6f\u4ef6\u5305 - \u5220\u9664 oauthapp.package.releasehistory \u8f6f\u4ef6\u5305 - \u53d1\u5e03\u8bb0\u5f55 oauthapp.package.publish \u8f6f\u4ef6\u5305 - \u53d1\u5e03 oauthapp.package.precompile \u8f6f\u4ef6\u5305 - \u9884\u7f16\u8bd1 oauthapp.package.all \u6240\u6709\u6743\u9650 \u6807\u8bc6 \u00b6 code name oauthapp.identityresource.put \u66f4\u65b0 oauthapp.identityresource.post \u521b\u5efa oauthapp.identityresource.get \u5217\u8868 oauthapp.identityresource.detail \u8be6\u60c5 oauthapp.identityresource.delete \u5220\u9664 oauthapp.identityresource.all \u6240\u6709\u6743\u9650 \u89d2\u8272 \u00b6 code name oauthapp.role.delete \u5220\u9664 oauthapp.role.detail \u8be6\u60c5 oauthapp.role.put \u66f4\u65b0 oauthapp.role.post \u521b\u5efa oauthapp.role.get \u5217\u8868 oauthapp.role.all \u6240\u6709\u6743\u9650 \u79df\u6237 \u00b6 code name oauthapp.tenant.post \u521b\u5efa oauthapp.tenant.get \u5217\u8868 oauthapp.tenant.detail \u8be6\u60c5 oauthapp.tenant.delete \u5220\u9664 oauthapp.tenant.put \u66f4\u65b0 oauthapp.tenant.all \u6240\u6709\u6743\u9650 \u7528\u6237 \u00b6 code name oauthapp.user.verifyemail \u6ce8\u518c - \u53d1\u9001\u90ae\u4ef6\u9a8c\u8bc1\u7801 oauthapp.user.register \u6ce8\u518c oauthapp.user.put \u66f4\u65b0 oauthapp.user.post \u521b\u5efa oauthapp.user.head \u662f\u5426\u5b58\u5728 oauthapp.user.get \u5217\u8868 oauthapp.user.detail \u8be6\u60c5 oauthapp.user.delete \u5220\u9664 oauthapp.user.verifyphone \u6ce8\u518c - \u53d1\u9001\u624b\u673a\u9a8c\u8bc1\u7801 oauthapp.user.all \u6240\u6709\u6743\u9650 \u5176\u4ed6 \u00b6 code name oauthapp.all \u6240\u6709\u6743\u9650","title":"\u6743\u9650\u7801\u8868"},{"location":"scopes/#_1","text":"OAuthApp\u5185\u7f6e\u7684\u63a5\u53e3\u6743\u9650\uff0c\u4f7f\u7528Client\u8bf7\u6c42\u7528\u6237\u6388\u6743\u65f6\uff0cscope\u53c2\u6570\u53ef\u53c2\u8003\u4e0b\u9762\u7684code\u3002","title":"\u6743\u9650\u7801\u8868"},{"location":"scopes/#_2","text":"code name openid \u7528\u6237\u7684ID profile \u7528\u6237\u8d44\u6599\u8be6\u60c5 address \u8054\u7cfb\u5730\u5740 email \u90ae\u7bb1\u5730\u5740 phone \u624b\u673a\u53f7 role \u89d2\u8272 permission \u6743\u9650 offline_access \u8131\u673a\u8bbf\u95ee","title":"\u6807\u8bc6\u6743\u9650"},{"location":"scopes/#api","text":"code name oauthapp.apiresource.post \u521b\u5efa oauthapp.apiresource.get \u5217\u8868 oauthapp.apiresource.detail \u8be6\u60c5 oauthapp.apiresource.delete \u5220\u9664 oauthapp.apiresource.put \u66f4\u65b0 oauthapp.apiresource.scopes \u6743\u9650\u4ee3\u7801 oauthapp.apiresource.all \u6240\u6709\u6743\u9650","title":"API\u8d44\u6e90"},{"location":"scopes/#api_1","text":"code name oauthapp.apiscope.post \u521b\u5efa oauthapp.apiscope.get \u5217\u8868 oauthapp.apiscope.detail \u8be6\u60c5 oauthapp.apiscope.delete \u5220\u9664 oauthapp.apiscope.put \u66f4\u65b0","title":"API\u6743\u9650"},{"location":"scopes/#blob","text":"code name oauthapp.blob.file \u4e0a\u4f20\u89c6\u9891\u6216\u6587\u6863 oauthapp.blob.image \u4e0a\u4f20\u56fe\u7247 oauthapp.blob.base64 \u4f20base64\u683c\u5f0f\u7684png\u56fe\u7247 oauthapp.blob.all \u6240\u6709\u6743\u9650","title":"Blob"},{"location":"scopes/#_3","text":"code name oauthapp.client.put \u66f4\u65b0 oauthapp.client.postsecretkey \u751f\u6210\u5bc6\u94a5 oauthapp.client.post \u521b\u5efa oauthapp.client.issuetoken \u521b\u5efa\u4ee4\u724c oauthapp.client.get \u5217\u8868 oauthapp.client.detail \u8be6\u60c5 oauthapp.client.delete \u5220\u9664 oauthapp.client.all \u6240\u6709\u6743\u9650","title":"\u5ba2\u6237\u7aef"},{"location":"scopes/#_4","text":"code name oauthapp.package.get \u8f6f\u4ef6\u5305 - \u5217\u8868 oauthapp.package.detail \u8f6f\u4ef6\u5305 - \u8be6\u60c5 oauthapp.package.post \u8f6f\u4ef6\u5305 - \u521b\u5efa oauthapp.package.put \u8f6f\u4ef6\u5305 - \u66f4\u65b0 oauthapp.package.delete \u8f6f\u4ef6\u5305 - \u5220\u9664 oauthapp.package.releasehistory \u8f6f\u4ef6\u5305 - \u53d1\u5e03\u8bb0\u5f55 oauthapp.package.publish \u8f6f\u4ef6\u5305 - \u53d1\u5e03 oauthapp.package.precompile \u8f6f\u4ef6\u5305 - \u9884\u7f16\u8bd1 oauthapp.package.all \u6240\u6709\u6743\u9650","title":"\u8f6f\u4ef6\u5305"},{"location":"scopes/#_5","text":"code name oauthapp.identityresource.put \u66f4\u65b0 oauthapp.identityresource.post \u521b\u5efa oauthapp.identityresource.get \u5217\u8868 oauthapp.identityresource.detail \u8be6\u60c5 oauthapp.identityresource.delete \u5220\u9664 oauthapp.identityresource.all \u6240\u6709\u6743\u9650","title":"\u6807\u8bc6"},{"location":"scopes/#_6","text":"code name oauthapp.role.delete \u5220\u9664 oauthapp.role.detail \u8be6\u60c5 oauthapp.role.put \u66f4\u65b0 oauthapp.role.post \u521b\u5efa oauthapp.role.get \u5217\u8868 oauthapp.role.all \u6240\u6709\u6743\u9650","title":"\u89d2\u8272"},{"location":"scopes/#_7","text":"code name oauthapp.tenant.post \u521b\u5efa oauthapp.tenant.get \u5217\u8868 oauthapp.tenant.detail \u8be6\u60c5 oauthapp.tenant.delete \u5220\u9664 oauthapp.tenant.put \u66f4\u65b0 oauthapp.tenant.all \u6240\u6709\u6743\u9650","title":"\u79df\u6237"},{"location":"scopes/#_8","text":"code name oauthapp.user.verifyemail \u6ce8\u518c - \u53d1\u9001\u90ae\u4ef6\u9a8c\u8bc1\u7801 oauthapp.user.register \u6ce8\u518c oauthapp.user.put \u66f4\u65b0 oauthapp.user.post \u521b\u5efa oauthapp.user.head \u662f\u5426\u5b58\u5728 oauthapp.user.get \u5217\u8868 oauthapp.user.detail \u8be6\u60c5 oauthapp.user.delete \u5220\u9664 oauthapp.user.verifyphone \u6ce8\u518c - \u53d1\u9001\u624b\u673a\u9a8c\u8bc1\u7801 oauthapp.user.all \u6240\u6709\u6743\u9650","title":"\u7528\u6237"},{"location":"scopes/#_9","text":"code name oauthapp.all \u6240\u6709\u6743\u9650","title":"\u5176\u4ed6"},{"location":"sendcloud/","text":"\u914d\u7f6e\u77ed\u4fe1\u3001\u90ae\u4ef6\u670d\u52a1 \u00b6 \u5f53\u7528\u6237\u6ce8\u518c\u6210\u529f\u3001\u627e\u56de\u5bc6\u7801\u3001\u9a8c\u8bc1\u624b\u673a\u53f7\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 SendCloud\u670d\u52a1 \u5e76\u628a\u5bf9\u5e94\u7684\u8fde\u63a5\u5b57\u7b26\u4e32\u590d\u5236\u5230\u5982\u4e0b\u914d\u7f6e\u4e2d\u3002 appsettings.json 1 2 3 4 5 6 7 8 9 10 11 12 \"IdentityServer\" : { \"SMS\" : { \"apiUser\" : \"\" , \"apiKey\" : \"\" }, \"Email\" : { \"apiUser\" : \"\" , \"apiKey\" : \"\" , \"fromEmail\" : \"\" , \"fromName\" : \"\" } } \u914d\u7f6e\u90ae\u4ef6\u670d\u52a1 \u00b6 Startup.cs 1 2 3 4 public void ConfigureServices ( IServiceCollection services ) { services . AddSingleton < IEmailSender , EmailSender >(); } EmailSender.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 public class EmailSender : Microsoft . AspNetCore . Identity . UI . Services . IEmailSender { EmailService _sender ; public EmailSender ( EmailService sender ) { _sender = sender ; } public Task SendEmailAsync ( string email , string subject , string message ) { return _sender . SendEmailAsync ( \"\u90ae\u4ef6\u6a21\u677f\u7684key\" , subject , new string [ 1 ] { email }, new Dictionary < string , string []>() { { \"%subject%\" , new string [ 1 ]{ subject } }, { \"%message%\" , new string [ 1 ]{ message } } }); } }","title":"\u914d\u7f6e\u77ed\u4fe1\u3001\u90ae\u4ef6\u670d\u52a1"},{"location":"sendcloud/#_1","text":"\u5f53\u7528\u6237\u6ce8\u518c\u6210\u529f\u3001\u627e\u56de\u5bc6\u7801\u3001\u9a8c\u8bc1\u624b\u673a\u53f7\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 SendCloud\u670d\u52a1 \u5e76\u628a\u5bf9\u5e94\u7684\u8fde\u63a5\u5b57\u7b26\u4e32\u590d\u5236\u5230\u5982\u4e0b\u914d\u7f6e\u4e2d\u3002 appsettings.json 1 2 3 4 5 6 7 8 9 10 11 12 \"IdentityServer\" : { \"SMS\" : { \"apiUser\" : \"\" , \"apiKey\" : \"\" }, \"Email\" : { \"apiUser\" : \"\" , \"apiKey\" : \"\" , \"fromEmail\" : \"\" , \"fromName\" : \"\" } }","title":"\u914d\u7f6e\u77ed\u4fe1\u3001\u90ae\u4ef6\u670d\u52a1"},{"location":"sendcloud/#_2","text":"Startup.cs 1 2 3 4 public void ConfigureServices ( IServiceCollection services ) { services . AddSingleton < IEmailSender , EmailSender >(); } EmailSender.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 public class EmailSender : Microsoft . AspNetCore . Identity . UI . Services . IEmailSender { EmailService _sender ; public EmailSender ( EmailService sender ) { _sender = sender ; } public Task SendEmailAsync ( string email , string subject , string message ) { return _sender . SendEmailAsync ( \"\u90ae\u4ef6\u6a21\u677f\u7684key\" , subject , new string [ 1 ] { email }, new Dictionary < string , string []>() { { \"%subject%\" , new string [ 1 ]{ subject } }, { \"%message%\" , new string [ 1 ]{ message } } }); } }","title":"\u914d\u7f6e\u90ae\u4ef6\u670d\u52a1"},{"location":"settings/","text":"OAuthApp\u914d\u7f6e \u00b6 \u9ed8\u8ba4\u7ba1\u7406\u5458 \u00b6 Startup.cs 1 2 3 4 5 6 7 8 9 10 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options => { //\u9ed8\u8ba4\uff1aadmin@admin.com options . DefaultUserAccount = \"admin@admin.com\" ; //\u9ed8\u8ba4\u4e3a\uff1a123456aA! options . DefaultUserPassword = \"123456aA!\" ; }); } \u63a5\u53e3\u6587\u6863 \u00b6 \u8bbe\u7f6e EnableReDoc=true \u540e\uff0c\u53ef\u4e3a\u5f53\u524d\u9879\u76ee\u751f\u6210\u63a5\u53e3\u6587\u6863\u3002 ReDocExtensions Startup.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options => { // \u751f\u6210\u63a5\u53e3\u6587\u6863\uff08\u9ed8\u8ba4\u4e3atrue\uff09 options . EnableReDoc = true ; // \u6587\u6863\u914d\u7f6e options . ReDocOptions = _options => { _options . DocumentTitle = \"OAuthApp\" ; _options . RoutePrefix = \"docs\" ; _options . SpecUrl ( \"/swagger/v1/swagger.json\" ); _options . EnableUntrustedSpec (); _options . ScrollYOffset ( 10 ); _options . HideHostname (); _options . HideDownloadButton (); _options . ExpandResponses ( \"200,201\" ); _options . RequiredPropsFirst (); _options . HideLoading (); _options . DisableSearch (); _options . SortPropsAlphabetically (); _options . OnlyRequiredInSamples (); _options . NoAutoAuth (); _options . PathInMiddlePanel (); _options . NativeScrollbars (); }; // \u6587\u6863\u4e2a\u6027\u5316 options . ReDocExtensions = ( Extensions => { Extensions . Add ( \"x-logo\" , new OpenApiObject { [\"url\"] = new OpenApiString ( \"https://www.oauthapp.com/images/oauthapp.png\" ), [\"backgroundColor\"] = new OpenApiString ( \"#ffffff\" ), [\"altText\"] = new OpenApiString ( \"OAuthApp.com\" ), }); }); }); } \u8bbf\u95ee\u9650\u6d41 \u00b6 \u8bbe\u7f6e EnableClientRateLimit=true\u3001EnableIpRateLimit=true \u540e\uff0c\u53ef\u63a7\u5236 ClientIP \u3001 ClientID \u7684\u8bbf\u95ee\u9891\u7387\u3002 Startup.cs 1 2 3 4 5 6 7 8 9 10 11 ublic void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options => { // \u542f\u7528Client\u9650\u6d41\uff08\u9ed8\u8ba4\u4e3afalse\uff09 options . EnableClientRateLimit = true ; // \u542f\u7528Ip\u9650\u6d41\uff08\u9ed8\u8ba4\u4e3afalse\uff09 options . EnableIpRateLimit = true ; }); } appsettings.json(Ip\u9650\u6d41) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 \"IpRateLimiting\" : { \"EnableEndpointRateLimiting\" : false , \"StackBlockedRequests\" : false , \"RealIpHeader\" : \"X-Real-IP\" , \"ClientIdHeader\" : \"X-ClientId\" , \"HttpStatusCode\" : 429 , \"IpWhitelist\" : [ \"127.0.0.1\" , \"::1/10\" , \"192.168.0.0/24\" ], \"EndpointWhitelist\" : [ \"get:/api/license\" , \"*:/api/status\" ], \"ClientWhitelist\" : [ \"dev-id-1\" , \"dev-id-2\" ], \"GeneralRules\" : [ { \"Endpoint\" : \"*\" , \"Period\" : \"1s\" , \"Limit\" : 2 }, { \"Endpoint\" : \"*\" , \"Period\" : \"15m\" , \"Limit\" : 100 }, { \"Endpoint\" : \"*\" , \"Period\" : \"12h\" , \"Limit\" : 1000 }, { \"Endpoint\" : \"*\" , \"Period\" : \"7d\" , \"Limit\" : 10000 } ] } appsettings.json(Client\u9650\u6d41) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \"ClientRateLimiting\" : { \"EnableEndpointRateLimiting\" : false , \"StackBlockedRequests\" : false , \"ClientIdHeader\" : \"X-ClientId\" , \"HttpStatusCode\" : 429 , \"EndpointWhitelist\" : [ \"get:/api/license\" , \"*:/api/status\" ], \"ClientWhitelist\" : [ \"dev-id-1\" , \"dev-id-2\" ], \"GeneralRules\" : [ { \"Endpoint\" : \"*\" , \"Period\" : \"1s\" , \"Limit\" : 2 }, { \"Endpoint\" : \"*\" , \"Period\" : \"15m\" , \"Limit\" : 100 }, { \"Endpoint\" : \"*\" , \"Period\" : \"12h\" , \"Limit\" : 1000 }, { \"Endpoint\" : \"*\" , \"Period\" : \"7d\" , \"Limit\" : 10000 } ] } \u8c03\u8bd5\u5de5\u5177 \u00b6 \u8bbe\u7f6e EnableSwaggerGen=true\u3001EnableSwaggerUI=true\u3001EnableAPIDocuments=true \uff0c\u53ef\u65b9\u4fbf\u5f00\u53d1\u4eba\u5458\u8c03\u8bd5\u63a5\u53e3\uff0c\u4e5f\u53ef\u901a\u8fc7 OAuthAppOptions.APIDocuments.Add \u9690\u85cf\u6307\u5b9a\u6587\u6863 Startup.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options => { //\u751f\u6210swagger.json\u6587\u6863\uff08\u9ed8\u8ba4\u4e3atrue\uff09 options . EnableSwaggerGen = true ; //\u542f\u7528swaggerUI\uff08\u9ed8\u8ba4\u4e3atrue\uff09\uff0cEnableSwaggerGen\u5fc5\u987b\u4e3atrue options . EnableSwaggerUI = true ; //\u5728swaggerUI\u4e2d\u9690\u85cfOAuthApp\u7684API\u6587\u6863\uff08\u9ed8\u8ba4\u4e3atrue\uff09\uff0c\u5f53\u524d\u9879\u76ee\u7684API\u4ecd\u4f1a\u5c55\u793a options . EnableAPIDocuments = true ; //\u5728swaggerUI\u4e2d\u9690\u85cf\u6307\u5b9aOAuthApp\u7684API\u6587\u6863 //OAuthAppOptions.APIDocuments.Add }); } \u7248\u672c\u53f7 \u00b6 \u8bbe\u7f6e EnableApiVersioning=true \u540e\uff0c\u53ef\u542f\u7528\u7248\u672c\u529f\u80fd\u3002\u4f8b\u5982\uff1a /api/foo?api-version=1.0 /api/foo?api-version=2.0-Alpha /api/foo?api-version=2015-05-01.3.0 /api/v1/foo /api/v2.0-Alpha/foo /api/v2015-05-01.3.0/foo aspnet-api-versioning Startup.cs 1 2 3 4 5 6 7 8 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options => { // \u9ed8\u8ba4\u4e3atrue options . EnableApiVersioning = true ; }); } DemoController.cs 1 2 3 4 5 6 [ApiVersion(\"2.0\")] [ApiController] public class DemoController : ControllerBase { } \u8de8\u57df \u00b6 \u8bbe\u7f6e EnableCors=true \u540e\uff0c\u53ef\u4ee5\u542f\u7528\u8de8\u57df\u529f\u80fd\u3002 Startup.cs 1 2 3 4 5 6 7 8 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options => { // \u9ed8\u8ba4\u4e3atrue options . EnableCors = true ; }); } appsettings.json 1 2 3 IdentityServer : { Origins : \"http://127.0.0.1:8080,http://127.0.0.1:8888\" } Aspnet Core Identity \u00b6 \u76f8\u5173\u914d\u7f6e\u53ef\u53c2\u8003 Configure ASP.NET Core Identity Startup.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options =>{ options . AspNetCoreIdentityOptions = identityOptions =>{ identityOptions . Lockout . DefaultLockoutTimeSpan = TimeSpan . FromMinutes ( 5 ); identityOptions . Lockout . MaxFailedAccessAttempts = 5 ; identityOptions . Lockout . AllowedForNewUsers = true // Default Password settings. // \u9700\u8981\u4ecb\u4e8e 0-9 \u7684\u5bc6\u7801 identityOptions . Password . RequireDigit = false ; // \u8981\u6c42\u5bc6\u7801\u4e2d\u7684\u5c0f\u5199\u5b57\u7b26 identityOptions . Password . RequireLowercase = false ; // \u9700\u8981\u5728\u5bc6\u7801\u4e2d\u7684\u975e\u5b57\u6bcd\u6570\u5b57\u5b57\u7b26 identityOptions . Password . RequireNonAlphanumeric = false ; // \u9700\u8981\u5927\u5199\u5b57\u7b26\u7684\u5bc6\u7801 identityOptions . Password . RequireUppercase = false ; // \u5bc6\u7801\u6700\u5c0f\u957f\u5ea6 identityOptions . Password . RequiredLength = 6 ; // \u8981\u6c42\u5728\u5bc6\u7801\u4e2d\u975e\u91cd\u590d\u5b57\u7b26\u6570 identityOptions . Password . RequiredUniqueChars = 1 ; // Default SignIn settings. identityOptions . SignIn . RequireConfirmedEmail = false ; identityOptions . SignIn . RequireConfirmedPhoneNumber = false // Default User settings. identityOptions . User . AllowedUserNameCharacters = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._@+\" ; identityOptions . User . RequireUniqueEmail = true ; } }); } Identity Server 4 \u00b6 \u76f8\u5173\u914d\u7f6e\u53ef\u53c2\u8003 IdentityServer Options Startup.cs 1 2 3 4 5 6 7 8 9 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options => { // \u901a\u8fc7\u4e0b\u9762\u7684\u5bf9\u8c61\u914d\u7f6eidentityserver4 // options.IdentityServerBuilder // options.IdentityServerOptions }); }","title":"OAuthApp\u914d\u7f6e"},{"location":"settings/#oauthapp","text":"","title":"OAuthApp\u914d\u7f6e"},{"location":"settings/#_1","text":"Startup.cs 1 2 3 4 5 6 7 8 9 10 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options => { //\u9ed8\u8ba4\uff1aadmin@admin.com options . DefaultUserAccount = \"admin@admin.com\" ; //\u9ed8\u8ba4\u4e3a\uff1a123456aA! options . DefaultUserPassword = \"123456aA!\" ; }); }","title":"\u9ed8\u8ba4\u7ba1\u7406\u5458"},{"location":"settings/#_2","text":"\u8bbe\u7f6e EnableReDoc=true \u540e\uff0c\u53ef\u4e3a\u5f53\u524d\u9879\u76ee\u751f\u6210\u63a5\u53e3\u6587\u6863\u3002 ReDocExtensions Startup.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options => { // \u751f\u6210\u63a5\u53e3\u6587\u6863\uff08\u9ed8\u8ba4\u4e3atrue\uff09 options . EnableReDoc = true ; // \u6587\u6863\u914d\u7f6e options . ReDocOptions = _options => { _options . DocumentTitle = \"OAuthApp\" ; _options . RoutePrefix = \"docs\" ; _options . SpecUrl ( \"/swagger/v1/swagger.json\" ); _options . EnableUntrustedSpec (); _options . ScrollYOffset ( 10 ); _options . HideHostname (); _options . HideDownloadButton (); _options . ExpandResponses ( \"200,201\" ); _options . RequiredPropsFirst (); _options . HideLoading (); _options . DisableSearch (); _options . SortPropsAlphabetically (); _options . OnlyRequiredInSamples (); _options . NoAutoAuth (); _options . PathInMiddlePanel (); _options . NativeScrollbars (); }; // \u6587\u6863\u4e2a\u6027\u5316 options . ReDocExtensions = ( Extensions => { Extensions . Add ( \"x-logo\" , new OpenApiObject { [\"url\"] = new OpenApiString ( \"https://www.oauthapp.com/images/oauthapp.png\" ), [\"backgroundColor\"] = new OpenApiString ( \"#ffffff\" ), [\"altText\"] = new OpenApiString ( \"OAuthApp.com\" ), }); }); }); }","title":"\u63a5\u53e3\u6587\u6863"},{"location":"settings/#_3","text":"\u8bbe\u7f6e EnableClientRateLimit=true\u3001EnableIpRateLimit=true \u540e\uff0c\u53ef\u63a7\u5236 ClientIP \u3001 ClientID \u7684\u8bbf\u95ee\u9891\u7387\u3002 Startup.cs 1 2 3 4 5 6 7 8 9 10 11 ublic void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options => { // \u542f\u7528Client\u9650\u6d41\uff08\u9ed8\u8ba4\u4e3afalse\uff09 options . EnableClientRateLimit = true ; // \u542f\u7528Ip\u9650\u6d41\uff08\u9ed8\u8ba4\u4e3afalse\uff09 options . EnableIpRateLimit = true ; }); } appsettings.json(Ip\u9650\u6d41) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 \"IpRateLimiting\" : { \"EnableEndpointRateLimiting\" : false , \"StackBlockedRequests\" : false , \"RealIpHeader\" : \"X-Real-IP\" , \"ClientIdHeader\" : \"X-ClientId\" , \"HttpStatusCode\" : 429 , \"IpWhitelist\" : [ \"127.0.0.1\" , \"::1/10\" , \"192.168.0.0/24\" ], \"EndpointWhitelist\" : [ \"get:/api/license\" , \"*:/api/status\" ], \"ClientWhitelist\" : [ \"dev-id-1\" , \"dev-id-2\" ], \"GeneralRules\" : [ { \"Endpoint\" : \"*\" , \"Period\" : \"1s\" , \"Limit\" : 2 }, { \"Endpoint\" : \"*\" , \"Period\" : \"15m\" , \"Limit\" : 100 }, { \"Endpoint\" : \"*\" , \"Period\" : \"12h\" , \"Limit\" : 1000 }, { \"Endpoint\" : \"*\" , \"Period\" : \"7d\" , \"Limit\" : 10000 } ] } appsettings.json(Client\u9650\u6d41) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \"ClientRateLimiting\" : { \"EnableEndpointRateLimiting\" : false , \"StackBlockedRequests\" : false , \"ClientIdHeader\" : \"X-ClientId\" , \"HttpStatusCode\" : 429 , \"EndpointWhitelist\" : [ \"get:/api/license\" , \"*:/api/status\" ], \"ClientWhitelist\" : [ \"dev-id-1\" , \"dev-id-2\" ], \"GeneralRules\" : [ { \"Endpoint\" : \"*\" , \"Period\" : \"1s\" , \"Limit\" : 2 }, { \"Endpoint\" : \"*\" , \"Period\" : \"15m\" , \"Limit\" : 100 }, { \"Endpoint\" : \"*\" , \"Period\" : \"12h\" , \"Limit\" : 1000 }, { \"Endpoint\" : \"*\" , \"Period\" : \"7d\" , \"Limit\" : 10000 } ] }","title":"\u8bbf\u95ee\u9650\u6d41"},{"location":"settings/#_4","text":"\u8bbe\u7f6e EnableSwaggerGen=true\u3001EnableSwaggerUI=true\u3001EnableAPIDocuments=true \uff0c\u53ef\u65b9\u4fbf\u5f00\u53d1\u4eba\u5458\u8c03\u8bd5\u63a5\u53e3\uff0c\u4e5f\u53ef\u901a\u8fc7 OAuthAppOptions.APIDocuments.Add \u9690\u85cf\u6307\u5b9a\u6587\u6863 Startup.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options => { //\u751f\u6210swagger.json\u6587\u6863\uff08\u9ed8\u8ba4\u4e3atrue\uff09 options . EnableSwaggerGen = true ; //\u542f\u7528swaggerUI\uff08\u9ed8\u8ba4\u4e3atrue\uff09\uff0cEnableSwaggerGen\u5fc5\u987b\u4e3atrue options . EnableSwaggerUI = true ; //\u5728swaggerUI\u4e2d\u9690\u85cfOAuthApp\u7684API\u6587\u6863\uff08\u9ed8\u8ba4\u4e3atrue\uff09\uff0c\u5f53\u524d\u9879\u76ee\u7684API\u4ecd\u4f1a\u5c55\u793a options . EnableAPIDocuments = true ; //\u5728swaggerUI\u4e2d\u9690\u85cf\u6307\u5b9aOAuthApp\u7684API\u6587\u6863 //OAuthAppOptions.APIDocuments.Add }); }","title":"\u8c03\u8bd5\u5de5\u5177"},{"location":"settings/#_5","text":"\u8bbe\u7f6e EnableApiVersioning=true \u540e\uff0c\u53ef\u542f\u7528\u7248\u672c\u529f\u80fd\u3002\u4f8b\u5982\uff1a /api/foo?api-version=1.0 /api/foo?api-version=2.0-Alpha /api/foo?api-version=2015-05-01.3.0 /api/v1/foo /api/v2.0-Alpha/foo /api/v2015-05-01.3.0/foo aspnet-api-versioning Startup.cs 1 2 3 4 5 6 7 8 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options => { // \u9ed8\u8ba4\u4e3atrue options . EnableApiVersioning = true ; }); } DemoController.cs 1 2 3 4 5 6 [ApiVersion(\"2.0\")] [ApiController] public class DemoController : ControllerBase { }","title":"\u7248\u672c\u53f7"},{"location":"settings/#_6","text":"\u8bbe\u7f6e EnableCors=true \u540e\uff0c\u53ef\u4ee5\u542f\u7528\u8de8\u57df\u529f\u80fd\u3002 Startup.cs 1 2 3 4 5 6 7 8 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options => { // \u9ed8\u8ba4\u4e3atrue options . EnableCors = true ; }); } appsettings.json 1 2 3 IdentityServer : { Origins : \"http://127.0.0.1:8080,http://127.0.0.1:8888\" }","title":"\u8de8\u57df"},{"location":"settings/#aspnet-core-identity","text":"\u76f8\u5173\u914d\u7f6e\u53ef\u53c2\u8003 Configure ASP.NET Core Identity Startup.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options =>{ options . AspNetCoreIdentityOptions = identityOptions =>{ identityOptions . Lockout . DefaultLockoutTimeSpan = TimeSpan . FromMinutes ( 5 ); identityOptions . Lockout . MaxFailedAccessAttempts = 5 ; identityOptions . Lockout . AllowedForNewUsers = true // Default Password settings. // \u9700\u8981\u4ecb\u4e8e 0-9 \u7684\u5bc6\u7801 identityOptions . Password . RequireDigit = false ; // \u8981\u6c42\u5bc6\u7801\u4e2d\u7684\u5c0f\u5199\u5b57\u7b26 identityOptions . Password . RequireLowercase = false ; // \u9700\u8981\u5728\u5bc6\u7801\u4e2d\u7684\u975e\u5b57\u6bcd\u6570\u5b57\u5b57\u7b26 identityOptions . Password . RequireNonAlphanumeric = false ; // \u9700\u8981\u5927\u5199\u5b57\u7b26\u7684\u5bc6\u7801 identityOptions . Password . RequireUppercase = false ; // \u5bc6\u7801\u6700\u5c0f\u957f\u5ea6 identityOptions . Password . RequiredLength = 6 ; // \u8981\u6c42\u5728\u5bc6\u7801\u4e2d\u975e\u91cd\u590d\u5b57\u7b26\u6570 identityOptions . Password . RequiredUniqueChars = 1 ; // Default SignIn settings. identityOptions . SignIn . RequireConfirmedEmail = false ; identityOptions . SignIn . RequireConfirmedPhoneNumber = false // Default User settings. identityOptions . User . AllowedUserNameCharacters = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._@+\" ; identityOptions . User . RequireUniqueEmail = true ; } }); }","title":"Aspnet Core Identity"},{"location":"settings/#identity-server-4","text":"\u76f8\u5173\u914d\u7f6e\u53ef\u53c2\u8003 IdentityServer Options Startup.cs 1 2 3 4 5 6 7 8 9 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( options => { // \u901a\u8fc7\u4e0b\u9762\u7684\u5bf9\u8c61\u914d\u7f6eidentityserver4 // options.IdentityServerBuilder // options.IdentityServerOptions }); }","title":"Identity Server 4"},{"location":"start-server/","text":"\u5b89\u88c5 \u00b6 \u4f7f\u7528OAuthApp\u53ef\u4ee5\u5feb\u901f\u5efa\u7acbOAuth2.0\u7684Saas\u7528\u6237\u4e2d\u5fc3\u3002\u53c2\u8003\u5982\u4e0b\u6b65\u9aa4\u521b\u5efa\u9879\u76ee\u5e76\u786e\u4fdd\u5df2\u5b89\u88c5 Visual Studio 2019 \u3001 DotNet Core 3.1+ \u3001 SQL Server \u3002 1\uff0c\u521b\u5efa\u5e94\u7528\u7a0b\u5e8f \u00b6 2\uff0c\u5b89\u88c5Nuget\u5305 \u00b6 \u5bf9\u9879\u76ee\u7684\u4f9d\u8d56\u9879\u70b9\u53f3\u952e\uff0c\u9009\u62e9\u7ba1\u7406Nuget\u7a0b\u5e8f\u5305 \u8f93\u5165OAuthApp\uff0c\u7136\u540e\u70b9\u51fb\u5b89\u88c5 3\uff0c\u914d\u7f6e \u00b6 3.1 appsetting.json \u00b6 \u5bf9\u9879\u76ee\u4f9d\u6b21\u70b9\u51fb\u9f20\u6807\u53f3\u952e\u2014\u2014\u5c5e\u6027\u2014\u2014\u8c03\u8bd5\uff0c\u590d\u5236\u9879\u76ee\u7f51\u5740. \u590d\u5236\u4e0b\u9762\u4ee3\u7801\u5230 appsetting.json \u6587\u4ef6\uff0c\u6ce8\u610f\u5c06Host\u8282\u70b9\u66ff\u6362\u4e3a\u5f53\u524d\u9879\u76ee\u7f51\u5740\uff0c \u7ed3\u5c3e\u4e0d\u8981\u5e26\u201c/\u201d \u3002 DataBaseConnection \u53ef\u66ff\u6362\u4e3a\u5b9e\u9645\u6570\u636e\u5e93\u7684\u5730\u5740\uff0c SMS \u548c Email \u4f7f\u7528\u7684\u662f SendCloud \u7684\u670d\u52a1\u3002 appsetting.json 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \"ConnectionStrings\" : { \"DataBaseConnection\" : \"Data Source=(localdb)\\\\ProjectsV13;Initial Catalog=ismsdb_demo;Integrated Security=True;Pooling=False\" , \"AzureStorageConnection\" : \"\u53ef\u7a7a\" } , \"IdentityServer\" : { \"Host\" : \"\u5f53\u524d\u9879\u76ee\u7f51\u5740\uff0c\u7ed3\u5c3e\u4e0d\u8981\u5230/\" , \"SMS\" : { \"apiUser\" : \"\u53ef\u7a7a\" , \"apiKey\" : \"\u53ef\u7a7a\" }, \"Email\" : { \"apiUser\" : \"\u53ef\u7a7a\" , \"apiKey\" : \"\u53ef\u7a7a\" , \"fromEmail\" : \"\u53ef\u7a7a\" , \"fromName\" : \"\u53ef\u7a7a\" } } 3.2 Identity UI \u00b6 \u6253\u5f00\u9879\u76ee\u7684 Views/Shared/_Layout.cshtml \u6587\u4ef6\uff0c\u6dfb\u52a0\u767b\u9646\u7ec4\u4ef6\u3002 Views/Shared/_Layout.cshtml 1 < partial name = \"_LoginPartial\" /> 3.3 \u6dfb\u52a0\u5e76\u5f15\u7528\u670d\u52a1 \u00b6 \u6253\u5f00 Startup.cs \u6587\u4ef6\uff0c\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801\u3002 Startup.cs 1 2 3 4 5 6 7 8 9 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp (); } public void Configure ( IApplicationBuilder app , IWebHostEnvironment env ) { app . UseOAuthApp (); } 4\uff0c \u542f\u52a8 \u00b6 \u542f\u52a8\u9879\u76ee\u5e76\u9884\u89c8\u3002\u9ed8\u8ba4\u7528\u6237\u8d26\u53f7\uff1a admin@admin.com \uff0c\u5bc6\u7801\uff1a123456aA!\uff0c\u62e5\u6709\u6240\u6709\u6743\u9650\u3002 5\uff0c Swagger UI \u00b6 \u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 {\u9879\u76ee\u7f51\u5740} /swagger/index.html\u53ef\u8bbf\u95eeAPI\u6587\u6863\u3002 \u53ef\u8bbf\u95ee {\u9879\u76ee\u7f51\u5740} /grants\uff0c\u64a4\u9500\u5bf9\u6307\u5b9aclient\u7684\u6388\u6743\u3002 6\uff0cPostman \u00b6 \u4f7f\u7528 Postman \u6d4b\u8bd5\u73b0\u6709\u63a5\u53e3\u3002","title":"\u5b89\u88c5"},{"location":"start-server/#_1","text":"\u4f7f\u7528OAuthApp\u53ef\u4ee5\u5feb\u901f\u5efa\u7acbOAuth2.0\u7684Saas\u7528\u6237\u4e2d\u5fc3\u3002\u53c2\u8003\u5982\u4e0b\u6b65\u9aa4\u521b\u5efa\u9879\u76ee\u5e76\u786e\u4fdd\u5df2\u5b89\u88c5 Visual Studio 2019 \u3001 DotNet Core 3.1+ \u3001 SQL Server \u3002","title":"\u5b89\u88c5"},{"location":"start-server/#1","text":"","title":"1\uff0c\u521b\u5efa\u5e94\u7528\u7a0b\u5e8f"},{"location":"start-server/#2nuget","text":"\u5bf9\u9879\u76ee\u7684\u4f9d\u8d56\u9879\u70b9\u53f3\u952e\uff0c\u9009\u62e9\u7ba1\u7406Nuget\u7a0b\u5e8f\u5305 \u8f93\u5165OAuthApp\uff0c\u7136\u540e\u70b9\u51fb\u5b89\u88c5","title":"2\uff0c\u5b89\u88c5Nuget\u5305"},{"location":"start-server/#3","text":"","title":"3\uff0c\u914d\u7f6e"},{"location":"start-server/#31-appsettingjson","text":"\u5bf9\u9879\u76ee\u4f9d\u6b21\u70b9\u51fb\u9f20\u6807\u53f3\u952e\u2014\u2014\u5c5e\u6027\u2014\u2014\u8c03\u8bd5\uff0c\u590d\u5236\u9879\u76ee\u7f51\u5740. \u590d\u5236\u4e0b\u9762\u4ee3\u7801\u5230 appsetting.json \u6587\u4ef6\uff0c\u6ce8\u610f\u5c06Host\u8282\u70b9\u66ff\u6362\u4e3a\u5f53\u524d\u9879\u76ee\u7f51\u5740\uff0c \u7ed3\u5c3e\u4e0d\u8981\u5e26\u201c/\u201d \u3002 DataBaseConnection \u53ef\u66ff\u6362\u4e3a\u5b9e\u9645\u6570\u636e\u5e93\u7684\u5730\u5740\uff0c SMS \u548c Email \u4f7f\u7528\u7684\u662f SendCloud \u7684\u670d\u52a1\u3002 appsetting.json 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \"ConnectionStrings\" : { \"DataBaseConnection\" : \"Data Source=(localdb)\\\\ProjectsV13;Initial Catalog=ismsdb_demo;Integrated Security=True;Pooling=False\" , \"AzureStorageConnection\" : \"\u53ef\u7a7a\" } , \"IdentityServer\" : { \"Host\" : \"\u5f53\u524d\u9879\u76ee\u7f51\u5740\uff0c\u7ed3\u5c3e\u4e0d\u8981\u5230/\" , \"SMS\" : { \"apiUser\" : \"\u53ef\u7a7a\" , \"apiKey\" : \"\u53ef\u7a7a\" }, \"Email\" : { \"apiUser\" : \"\u53ef\u7a7a\" , \"apiKey\" : \"\u53ef\u7a7a\" , \"fromEmail\" : \"\u53ef\u7a7a\" , \"fromName\" : \"\u53ef\u7a7a\" } }","title":"3.1 appsetting.json"},{"location":"start-server/#32-identity-ui","text":"\u6253\u5f00\u9879\u76ee\u7684 Views/Shared/_Layout.cshtml \u6587\u4ef6\uff0c\u6dfb\u52a0\u767b\u9646\u7ec4\u4ef6\u3002 Views/Shared/_Layout.cshtml 1 < partial name = \"_LoginPartial\" />","title":"3.2 Identity UI"},{"location":"start-server/#33","text":"\u6253\u5f00 Startup.cs \u6587\u4ef6\uff0c\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801\u3002 Startup.cs 1 2 3 4 5 6 7 8 9 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp (); } public void Configure ( IApplicationBuilder app , IWebHostEnvironment env ) { app . UseOAuthApp (); }","title":"3.3 \u6dfb\u52a0\u5e76\u5f15\u7528\u670d\u52a1"},{"location":"start-server/#4","text":"\u542f\u52a8\u9879\u76ee\u5e76\u9884\u89c8\u3002\u9ed8\u8ba4\u7528\u6237\u8d26\u53f7\uff1a admin@admin.com \uff0c\u5bc6\u7801\uff1a123456aA!\uff0c\u62e5\u6709\u6240\u6709\u6743\u9650\u3002","title":"4\uff0c    \u542f\u52a8"},{"location":"start-server/#5-swagger-ui","text":"\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 {\u9879\u76ee\u7f51\u5740} /swagger/index.html\u53ef\u8bbf\u95eeAPI\u6587\u6863\u3002 \u53ef\u8bbf\u95ee {\u9879\u76ee\u7f51\u5740} /grants\uff0c\u64a4\u9500\u5bf9\u6307\u5b9aclient\u7684\u6388\u6743\u3002","title":"5\uff0c   Swagger UI"},{"location":"start-server/#6postman","text":"\u4f7f\u7528 Postman \u6d4b\u8bd5\u73b0\u6709\u63a5\u53e3\u3002","title":"6\uff0cPostman"},{"location":"userinteraction/","text":"\u81ea\u5b9a\u4e49UI\u4ea4\u4e92\u754c\u9762 \u00b6 \u7528\u6237\u767b\u9646\u7684\u65b9\u5f0f\u5206\u4e3a3\u79cd\uff1a 1\uff0c \u7cfb\u7edf\u5185\u7f6e\u767b\u9646 \uff1a\u7528\u8d26\u53f7/\u90ae\u7bb1/\u624b\u673a\u53f7\u767b\u9646\u81ea\u5df1\u7684\u7cfb\u7edf\u3002 2\uff0c \u5916\u90e8OAuth\u5e94\u7528\u767b\u9646\u81ea\u5df1\u7684\u7cfb\u7edf \uff1a\u4f7f\u7528\u5fae\u4fe1/\u5fae\u535a/QQ/Github\u8d26\u53f7\u767b\u5f55\u81ea\u5df1\u7684\u7cfb\u7edf\u3002 3\uff0c \u81ea\u8eab\u7cfb\u7edf\u63d0\u4f9b\u767b\u9646\u670d\u52a1\u7ed9\u5916\u90e8 \uff1a\u521b\u5efaOAuth\u5e94\u7528\u4f9b\u7b2c\u4e09\u65b9\u4f7f\u7528\uff0c\u628a\u81ea\u5df1\u7cfb\u7edf\u7684\u7528\u6237\u4e0e\u5916\u90e8\u7cfb\u7edf\u7684\u7528\u6237\u94fe\u63a5\u8d77\u6765\u3002 \u901a\u8fc7\u8fd93\u79cd\u65b9\u5f0f\uff0c\u7cfb\u7edf\u4e0e\u7cfb\u7edf\u4e4b\u95f4\u7684\u7528\u6237\u6570\u636e\u4e5f\u5c31\u8054\u7cfb\u5728\u4e00\u8d77\u4e86\u3002 \u5355\u70b9\u767b\u9646UI\u4ea4\u4e92 \u00b6 \u5f53\u6211\u4eec\u7684\u7cfb\u7edf\u5bf9\u5916\u63d0\u4f9b\u5355\u70b9\u767b\u5f55\u670d\u52a1\u65f6\uff0c\u53ef\u81ea\u5b9a\u4e49UI\u4ea4\u4e92\u754c\u9762\uff0c\u5982\uff1a\u767b\u9646\u9875\u3001\u9000\u51fa\u9875\uff0c\u7528\u6237\u6388\u6743\u9875\uff0c\u6388\u6743\u7ba1\u7406\u9875\u3002 https://localhost:4200 \u662f\u81ea\u5b9a\u4e49\u7684\u524d\u7aef\u9875\u9762\u5730\u5740\uff0c\u4e0e\u670d\u52a1\u5668\u4ea4\u4e92\u65f6\uff0c\u4f1a\u81ea\u52a8\u8df3\u8f6c\u5230\u6307\u5b9a\u7684\u9875\u9762\uff0c\u524d\u7aef\u9875\u9762\u7ed3\u5408 Authing\u63a7\u5236\u5668 \u5373\u53ef\u5b9e\u73b0\u9a8c\u8bc1\u6d41\u7a0b\u3002 Startup.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( x => { x . IdentityServerOptions = options => { options . UserInteraction . LoginUrl = \"https://localhost:4200/sso/signin\" ; options . UserInteraction . DeviceVerificationUrl = \"https://localhost:4200/sso/signin-device\" ; options . UserInteraction . LogoutUrl = \"https://localhost:4200/sso/signout\" ; options . UserInteraction . ConsentUrl = \"https://localhost:4200/sso/consent\" ; options . UserInteraction . ErrorUrl = \"https://localhost:4200/sso/error\" ; }; }); } \u591a\u79df\u6237\u5355\u70b9\u767b\u9646UI\u4ea4\u4e92 \u00b6 \u591a\u79df\u6237\u6a21\u5f0f\u4e0b\uff0c\u5047\u8bbe\u67093\u4e2a\u7ad9\u70b9\u5206\u522b\u63d0\u4f9b\u5355\u70b9\u767b\u5f55\u670d\u52a1\uff0c\u53c8\u9700\u8981\u4e0d\u540c\u7684UI\u4ea4\u4e92\u754c\u9762\uff0c\u8fdb\u884c\u4ee5\u4e0b\u914d\u7f6e\u5373\u53ef https://app1.oauthapp.com https://app2.oauthapp.com https://app3.oauthapp.com Controllers/HomeController.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 public class TenantController : ApiControllerBase { private readonly TenantDbContext _tenantDb ; public TenantController ( TenantDbContext tenantDb ) { _tenantDb = tenantDb ; var app1 = new AppTenant () { Name = \"app1\" , IdentityServerIssuerUri = \"app1.oauthapp.com\" }; app1 . Hosts . Add ( new AppTenantHost () { HostName = \"app1.oauthapp.com\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LoginUrl , Value = \"https://localhost:4100/sso/signin\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LoginReturnUrlParameter , Value = \"app1\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LogoutUrl , Value = \"https://localhost:4100/sso/signout\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LogoutIdParameter , Value = \"app1\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ConsentUrl , Value = \"https://localhost:4100/sso/consent\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ConsentReturnUrlParameter , Value = \"app1\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ErrorUrl , Value = \"https://localhost:4100/sso/error\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ErrorIdParameter , Value = \"app1\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . CustomRedirectReturnUrlParameter , Value = \"app1\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . CookieMessageThreshold , Value = \"2\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . DeviceVerificationUrl , Value = \"https://localhost:4100/sso/signin-device\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . DeviceVerificationUserCodeParameter , Value = \"app1\" }); tenantDb . Tenants . Add ( app1 ); var app2 = new AppTenant () { Name = \"app2\" , IdentityServerIssuerUri = \"app2.oauthapp.com\" }; app1 . Hosts . Add ( new AppTenantHost () { HostName = \"app2.oauthapp.com\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LoginUrl , Value = \"https://localhost:4300/sso/signin\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LoginReturnUrlParameter , Value = \"app2\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LogoutUrl , Value = \"https://localhost:4300/sso/signout\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LogoutIdParameter , Value = \"app2\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ConsentUrl , Value = \"https://localhost:4300/sso/consent\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ConsentReturnUrlParameter , Value = \"app2\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ErrorUrl , Value = \"https://localhost:4300/sso/error\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ErrorIdParameter , Value = \"app2\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . CustomRedirectReturnUrlParameter , Value = \"app2\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . CookieMessageThreshold , Value = \"2\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . DeviceVerificationUrl , Value = \"https://localhost:4300/sso/signin-device\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . DeviceVerificationUserCodeParameter , Value = \"app2\" }); tenantDb . Tenants . Add ( app2 ); // app3 \u7565 tenantDb . SaveChanges (); } }","title":"\u81ea\u5b9a\u4e49UI\u4ea4\u4e92\u754c\u9762"},{"location":"userinteraction/#ui","text":"\u7528\u6237\u767b\u9646\u7684\u65b9\u5f0f\u5206\u4e3a3\u79cd\uff1a 1\uff0c \u7cfb\u7edf\u5185\u7f6e\u767b\u9646 \uff1a\u7528\u8d26\u53f7/\u90ae\u7bb1/\u624b\u673a\u53f7\u767b\u9646\u81ea\u5df1\u7684\u7cfb\u7edf\u3002 2\uff0c \u5916\u90e8OAuth\u5e94\u7528\u767b\u9646\u81ea\u5df1\u7684\u7cfb\u7edf \uff1a\u4f7f\u7528\u5fae\u4fe1/\u5fae\u535a/QQ/Github\u8d26\u53f7\u767b\u5f55\u81ea\u5df1\u7684\u7cfb\u7edf\u3002 3\uff0c \u81ea\u8eab\u7cfb\u7edf\u63d0\u4f9b\u767b\u9646\u670d\u52a1\u7ed9\u5916\u90e8 \uff1a\u521b\u5efaOAuth\u5e94\u7528\u4f9b\u7b2c\u4e09\u65b9\u4f7f\u7528\uff0c\u628a\u81ea\u5df1\u7cfb\u7edf\u7684\u7528\u6237\u4e0e\u5916\u90e8\u7cfb\u7edf\u7684\u7528\u6237\u94fe\u63a5\u8d77\u6765\u3002 \u901a\u8fc7\u8fd93\u79cd\u65b9\u5f0f\uff0c\u7cfb\u7edf\u4e0e\u7cfb\u7edf\u4e4b\u95f4\u7684\u7528\u6237\u6570\u636e\u4e5f\u5c31\u8054\u7cfb\u5728\u4e00\u8d77\u4e86\u3002","title":"\u81ea\u5b9a\u4e49UI\u4ea4\u4e92\u754c\u9762"},{"location":"userinteraction/#ui_1","text":"\u5f53\u6211\u4eec\u7684\u7cfb\u7edf\u5bf9\u5916\u63d0\u4f9b\u5355\u70b9\u767b\u5f55\u670d\u52a1\u65f6\uff0c\u53ef\u81ea\u5b9a\u4e49UI\u4ea4\u4e92\u754c\u9762\uff0c\u5982\uff1a\u767b\u9646\u9875\u3001\u9000\u51fa\u9875\uff0c\u7528\u6237\u6388\u6743\u9875\uff0c\u6388\u6743\u7ba1\u7406\u9875\u3002 https://localhost:4200 \u662f\u81ea\u5b9a\u4e49\u7684\u524d\u7aef\u9875\u9762\u5730\u5740\uff0c\u4e0e\u670d\u52a1\u5668\u4ea4\u4e92\u65f6\uff0c\u4f1a\u81ea\u52a8\u8df3\u8f6c\u5230\u6307\u5b9a\u7684\u9875\u9762\uff0c\u524d\u7aef\u9875\u9762\u7ed3\u5408 Authing\u63a7\u5236\u5668 \u5373\u53ef\u5b9e\u73b0\u9a8c\u8bc1\u6d41\u7a0b\u3002 Startup.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 public void ConfigureServices ( IServiceCollection services ) { services . AddOAuthApp ( x => { x . IdentityServerOptions = options => { options . UserInteraction . LoginUrl = \"https://localhost:4200/sso/signin\" ; options . UserInteraction . DeviceVerificationUrl = \"https://localhost:4200/sso/signin-device\" ; options . UserInteraction . LogoutUrl = \"https://localhost:4200/sso/signout\" ; options . UserInteraction . ConsentUrl = \"https://localhost:4200/sso/consent\" ; options . UserInteraction . ErrorUrl = \"https://localhost:4200/sso/error\" ; }; }); }","title":"\u5355\u70b9\u767b\u9646UI\u4ea4\u4e92"},{"location":"userinteraction/#ui_2","text":"\u591a\u79df\u6237\u6a21\u5f0f\u4e0b\uff0c\u5047\u8bbe\u67093\u4e2a\u7ad9\u70b9\u5206\u522b\u63d0\u4f9b\u5355\u70b9\u767b\u5f55\u670d\u52a1\uff0c\u53c8\u9700\u8981\u4e0d\u540c\u7684UI\u4ea4\u4e92\u754c\u9762\uff0c\u8fdb\u884c\u4ee5\u4e0b\u914d\u7f6e\u5373\u53ef https://app1.oauthapp.com https://app2.oauthapp.com https://app3.oauthapp.com Controllers/HomeController.cs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 public class TenantController : ApiControllerBase { private readonly TenantDbContext _tenantDb ; public TenantController ( TenantDbContext tenantDb ) { _tenantDb = tenantDb ; var app1 = new AppTenant () { Name = \"app1\" , IdentityServerIssuerUri = \"app1.oauthapp.com\" }; app1 . Hosts . Add ( new AppTenantHost () { HostName = \"app1.oauthapp.com\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LoginUrl , Value = \"https://localhost:4100/sso/signin\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LoginReturnUrlParameter , Value = \"app1\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LogoutUrl , Value = \"https://localhost:4100/sso/signout\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LogoutIdParameter , Value = \"app1\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ConsentUrl , Value = \"https://localhost:4100/sso/consent\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ConsentReturnUrlParameter , Value = \"app1\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ErrorUrl , Value = \"https://localhost:4100/sso/error\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ErrorIdParameter , Value = \"app1\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . CustomRedirectReturnUrlParameter , Value = \"app1\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . CookieMessageThreshold , Value = \"2\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . DeviceVerificationUrl , Value = \"https://localhost:4100/sso/signin-device\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . DeviceVerificationUserCodeParameter , Value = \"app1\" }); tenantDb . Tenants . Add ( app1 ); var app2 = new AppTenant () { Name = \"app2\" , IdentityServerIssuerUri = \"app2.oauthapp.com\" }; app1 . Hosts . Add ( new AppTenantHost () { HostName = \"app2.oauthapp.com\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LoginUrl , Value = \"https://localhost:4300/sso/signin\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LoginReturnUrlParameter , Value = \"app2\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LogoutUrl , Value = \"https://localhost:4300/sso/signout\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . LogoutIdParameter , Value = \"app2\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ConsentUrl , Value = \"https://localhost:4300/sso/consent\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ConsentReturnUrlParameter , Value = \"app2\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ErrorUrl , Value = \"https://localhost:4300/sso/error\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . ErrorIdParameter , Value = \"app2\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . CustomRedirectReturnUrlParameter , Value = \"app2\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . CookieMessageThreshold , Value = \"2\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . DeviceVerificationUrl , Value = \"https://localhost:4300/sso/signin-device\" }); app1 . Properties . Add ( new AppTenantProperty () { Key = UserInteractionKeys . DeviceVerificationUserCodeParameter , Value = \"app2\" }); tenantDb . Tenants . Add ( app2 ); // app3 \u7565 tenantDb . SaveChanges (); } }","title":"\u591a\u79df\u6237\u5355\u70b9\u767b\u9646UI\u4ea4\u4e92"}]}